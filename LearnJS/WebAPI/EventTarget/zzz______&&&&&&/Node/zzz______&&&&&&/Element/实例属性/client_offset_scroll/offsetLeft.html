<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>offsetLeft 属性详解</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        color: #333;
        line-height: 1.6;
        padding: 20px;
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      header {
        text-align: center;
        margin-bottom: 40px;
        padding: 20px;
        background: white;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      h1 {
        color: #2c3e50;
        margin-bottom: 10px;
        font-size: 2.5rem;
      }

      .subtitle {
        color: #7f8c8d;
        font-size: 1.2rem;
      }

      .content-wrapper {
        display: flex;
        flex-wrap: wrap;
        gap: 30px;
        margin-bottom: 40px;
      }

      .explanation {
        flex: 1;
        min-width: 300px;
        background: white;
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .demo-area {
        flex: 1;
        min-width: 300px;
        background: white;
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      h2 {
        color: #3498db;
        margin: 20px 0 15px;
        padding-bottom: 10px;
        border-bottom: 2px solid #f0f0f0;
      }

      h3 {
        color: #2c3e50;
        margin: 15px 0 10px;
      }

      p {
        margin-bottom: 15px;
      }

      ul,
      ol {
        margin: 0 0 15px 20px;
      }

      li {
        margin-bottom: 8px;
      }

      .positioned-container {
        position: relative;
        width: 100%;
        height: 300px;
        background-color: #e8f4f8;
        border: 2px dashed #3498db;
        margin: 20px 0;
        padding: 15px;
      }

      .target-element {
        position: absolute;
        left: 80px;
        top: 60px;
        width: 150px;
        height: 100px;
        background: linear-gradient(135deg, #e74c3c, #c0392b);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        font-weight: bold;
      }

      .target-element:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
      }

      .info-panel {
        background-color: #2c3e50;
        color: white;
        padding: 20px;
        border-radius: 8px;
        margin-top: 20px;
        font-family: "Courier New", monospace;
        line-height: 1.8;
      }

      .controls {
        display: flex;
        gap: 10px;
        margin-top: 20px;
        flex-wrap: wrap;
      }

      button {
        padding: 10px 15px;
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.2s;
        font-weight: bold;
        flex: 1;
        min-width: 120px;
      }

      button:hover {
        background-color: #2980b9;
      }

      .code-example {
        background-color: #2c3e50;
        color: #ecf0f1;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        overflow-x: auto;
        font-family: "Courier New", monospace;
        line-height: 1.5;
      }

      .comparison {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-top: 30px;
      }

      .comparison-item {
        flex: 1;
        min-width: 250px;
        padding: 20px;
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      }

      .comparison-item h3 {
        color: #3498db;
        margin-top: 0;
        padding-bottom: 10px;
        border-bottom: 1px solid #eee;
      }

      .note {
        background-color: #fff8e1;
        padding: 15px;
        border-radius: 6px;
        border-left: 4px solid #ffc107;
        margin: 20px 0;
      }

      .property-table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
      }

      .property-table th,
      .property-table td {
        border: 1px solid #ddd;
        padding: 12px;
        text-align: left;
      }

      .property-table th {
        background-color: #3498db;
        color: white;
      }

      .property-table tr:nth-child(even) {
        background-color: #f9f9f9;
      }

      .property-table tr:hover {
        background-color: #f1f1f1;
      }

      .visual-guide {
        display: flex;
        justify-content: space-between;
        margin: 20px 0;
        flex-wrap: wrap;
      }

      .guide-item {
        text-align: center;
        margin: 10px;
        flex: 1;
        min-width: 150px;
      }

      .guide-box {
        width: 100px;
        height: 60px;
        margin: 0 auto 10px;
        border: 2px solid #3498db;
        position: relative;
      }

      .guide-label {
        font-size: 0.9rem;
        color: #7f8c8d;
      }

      footer {
        text-align: center;
        margin-top: 40px;
        padding: 20px;
        color: #7f8c8d;
        font-size: 0.9rem;
      }

      @media (max-width: 768px) {
        .content-wrapper {
          flex-direction: column;
        }

        .comparison {
          flex-direction: column;
        }

        h1 {
          font-size: 2rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>offsetLeft 属性详解</h1>
        <p class="subtitle">深入理解元素定位与偏移量计算</p>
      </header>

      <div class="content-wrapper">
        <div class="explanation">
          <h2>什么是 offsetLeft？</h2>
          <p><code>offsetLeft</code> 是 JavaScript 中 DOM 元素的一个只读属性，返回当前元素相对于其 <strong>最近定位祖先元素</strong> 左侧边界的偏移距离（以像素为单位）。</p>

          <div class="code-example">
            // 获取元素的 offsetLeft 值<br />
            let element = document.getElementById("myElement");<br />
            let leftOffset = element.offsetLeft;<br />
            console.log(leftOffset); // 输出偏移量（像素）
          </div>

          <h3>关键特性：</h3>
          <ul>
            <li><strong>只读属性</strong> - 不能直接设置，只能读取</li>
            <li><strong>相对于定位祖先</strong> - 计算基于最近的定位祖先元素</li>
            <li><strong>包含边框和滚动条</strong> - 计算包含元素的边框和滚动条宽度</li>
            <li><strong>整数像素值</strong> - 返回值总是整数，四舍五入到最近的像素</li>
          </ul>

          <div class="note"><strong>注意：</strong> 如果元素没有定位祖先，则 offsetLeft 是相对于 <code>&lt;body&gt;</code> 元素或文档根元素计算的。</div>

          <h3>offsetLeft 计算原理</h3>
          <p>offsetLeft 的计算方式如下：</p>
          <ol>
            <li>查找元素的最近定位祖先（position 不为 static 的元素）</li>
            <li>计算从定位祖先左内边界到元素左外边界的距离</li>
            <li>返回该距离的像素值（整数）</li>
          </ol>

          <div class="visual-guide">
            <div class="guide-item">
              <div class="guide-box" style="background-color: #e8f4f8"></div>
              <div class="guide-label">定位祖先元素</div>
            </div>
            <div class="guide-item">
              <div class="guide-box" style="background-color: #e74c3c; margin-left: 30px"></div>
              <div class="guide-label">目标元素</div>
            </div>
            <div class="guide-item">
              <div style="display: flex; align-items: center; justify-content: center; height: 60px; margin-bottom: 10px">
                <div style="width: 80px; height: 2px; background: #3498db; position: relative">
                  <div style="position: absolute; top: -8px; left: 0; width: 0; height: 0; border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 10px solid #3498db"></div>
                  <div style="position: absolute; top: -8px; right: 0; width: 0; height: 0; border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 10px solid #3498db"></div>
                </div>
              </div>
              <div class="guide-label">offsetLeft 距离</div>
            </div>
          </div>
        </div>

        <div class="demo-area">
          <h2>交互演示</h2>
          <p>点击红色方块或使用控制按钮查看 offsetLeft 的变化：</p>

          <div class="positioned-container" id="positionedContainer">
            <div class="target-element" id="targetElement">目标元素</div>
          </div>

          <div class="info-panel" id="infoPanel">
            // 点击上方元素查看属性值<br />
            offsetLeft: --<br />
            offsetParent: --<br />
            style.left: --
          </div>

          <div class="controls">
            <button id="moveLeft">向左移动 ←</button>
            <button id="moveRight">向右移动 →</button>
            <button id="addPadding">增加内边距</button>
            <button id="reset">重置位置</button>
          </div>

          <h3>属性对比</h3>
          <table class="property-table">
            <tr>
              <th>属性</th>
              <th>描述</th>
              <th>是否只读</th>
            </tr>
            <tr>
              <td>offsetLeft</td>
              <td>元素相对于定位祖先的左偏移</td>
              <td>是</td>
            </tr>
            <tr>
              <td>offsetTop</td>
              <td>元素相对于定位祖先的上偏移</td>
              <td>是</td>
            </tr>
            <tr>
              <td>offsetWidth</td>
              <td>元素的宽度（包含边框和内边距）</td>
              <td>是</td>
            </tr>
            <tr>
              <td>style.left</td>
              <td>CSS left 属性值（仅当显式设置时）</td>
              <td>否</td>
            </tr>
          </table>
        </div>
      </div>

      <div class="comparison">
        <div class="comparison-item">
          <h3>offsetLeft 与相关属性</h3>
          <p><strong>offsetLeft:</strong> 相对于定位祖先的左偏移</p>
          <p><strong>clientLeft:</strong> 元素左边框的宽度</p>
          <p><strong>scrollLeft:</strong> 元素内容向左滚动的像素数</p>
          <p><strong>getBoundingClientRect().left:</strong> 相对于视口左侧的位置</p>
          <p><strong>pageXOffset:</strong> 文档水平滚动的像素数</p>
        </div>

        <div class="comparison-item">
          <h3>实际应用场景</h3>
          <p>• 动态定位元素</p>
          <p>• 实现拖放功能</p>
          <p>• 计算元素相对位置</p>
          <p>• 创建自定义滚动效果</p>
          <p>• 响应式布局计算</p>
        </div>

        <div class="comparison-item">
          <h3>注意事项</h3>
          <p>• 元素 display:none 时返回 0</p>
          <p>• 受父元素定位方式影响</p>
          <p>• 包含边框和滚动条宽度</p>
          <p>• 返回值总是整数像素</p>
          <p>• 性能优于 getBoundingClientRect()</p>
        </div>
      </div>

      <div class="code-example">
        // 实际使用示例：获取元素位置并动态定位其他元素<br />
        function positionRelativeTo(element, reference) {<br />
        &nbsp;&nbsp;let left = reference.offsetLeft + reference.offsetWidth + 10;<br />
        &nbsp;&nbsp;let top = reference.offsetTop;<br />
        &nbsp;&nbsp;element.style.left = left + 'px';<br />
        &nbsp;&nbsp;element.style.top = top + 'px';<br />
        }<br />
        <br />
        // 检测元素是否在可视区域内<br />
        function isElementInViewport(el) {<br />
        &nbsp;&nbsp;let rect = el.getBoundingClientRect();<br />
        &nbsp;&nbsp;return (<br />
        &nbsp;&nbsp;&nbsp;&nbsp;rect.top >= 0 &&<br />
        &nbsp;&nbsp;&nbsp;&nbsp;rect.left >= 0 &&<br />
        &nbsp;&nbsp;&nbsp;&nbsp;rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&<br />
        &nbsp;&nbsp;&nbsp;&nbsp;rect.right <= (window.innerWidth || document.documentElement.clientWidth)<br />
        &nbsp;&nbsp;);<br />
        }
      </div>

      <footer>
        <p>offsetLeft 属性详解 &copy; 2023 - 交互式前端教程</p>
      </footer>
    </div>

    <script>
      // 获取DOM元素
      const targetElement = document.getElementById("targetElement");
      const infoPanel = document.getElementById("infoPanel");
      const moveLeftBtn = document.getElementById("moveLeft");
      const moveRightBtn = document.getElementById("moveRight");
      const addPaddingBtn = document.getElementById("addPadding");
      const resetBtn = document.getElementById("reset");
      const positionedContainer = document.getElementById("positionedContainer");

      // 初始位置和状态
      let currentLeft = 80;
      let currentPadding = 15;

      // 更新信息面板
      function updateInfo() {
        const offsetLeft = targetElement.offsetLeft;
        const offsetParent = targetElement.offsetParent;
        const parentId = offsetParent ? offsetParent.id || offsetParent.className : "body";
        const styleLeft = targetElement.style.left;

        infoPanel.innerHTML = `
                // 元素位置属性<br>
                offsetLeft: <strong>${offsetLeft}px</strong><br>
                offsetParent: <strong>${parentId}</strong><br>
                style.left: <strong>${styleLeft || "未设置"}</strong><br>
                容器内边距: <strong>${currentPadding}px</strong>
            `;
      }

      // 初始更新
      updateInfo();

      // 点击目标元素显示offsetLeft
      targetElement.addEventListener("click", function () {
        updateInfo();
        // 添加点击反馈
        this.style.transform = "scale(0.95)";
        setTimeout(() => {
          this.style.transform = "";
        }, 200);
      });

      // 移动元素
      moveLeftBtn.addEventListener("click", function () {
        currentLeft = Math.max(10, currentLeft - 20);
        targetElement.style.left = currentLeft + "px";
        updateInfo();
      });

      moveRightBtn.addEventListener("click", function () {
        currentLeft = Math.min(250, currentLeft + 20);
        targetElement.style.left = currentLeft + "px";
        updateInfo();
      });

      // 添加内边距
      addPaddingBtn.addEventListener("click", function () {
        currentPadding += 10;
        positionedContainer.style.padding = currentPadding + "px";
        updateInfo();
      });

      // 重置位置
      resetBtn.addEventListener("click", function () {
        currentLeft = 80;
        currentPadding = 15;
        targetElement.style.left = currentLeft + "px";
        positionedContainer.style.padding = currentPadding + "px";
        updateInfo();
      });

      // 添加键盘控制
      document.addEventListener("keydown", function (e) {
        if (e.key === "ArrowLeft") {
          currentLeft = Math.max(10, currentLeft - 10);
          targetElement.style.left = currentLeft + "px";
          updateInfo();
        } else if (e.key === "ArrowRight") {
          currentLeft = Math.min(250, currentLeft + 10);
          targetElement.style.left = currentLeft + "px";
          updateInfo();
        }
      });

      // 初始信息显示
      setTimeout(updateInfo, 100);
    </script>
  </body>
</html>
