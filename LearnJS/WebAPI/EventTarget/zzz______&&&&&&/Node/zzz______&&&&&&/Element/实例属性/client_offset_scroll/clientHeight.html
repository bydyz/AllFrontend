<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>clientHeight å±æ€§è¯¦è§£</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        color: #333;
        line-height: 1.6;
        padding: 20px;
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      header {
        text-align: center;
        margin-bottom: 40px;
        padding: 30px;
        background: white;
        border-radius: 15px;
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
      }

      h1 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 2.5rem;
      }

      .subtitle {
        color: #7f8c8d;
        font-size: 1.3rem;
        max-width: 800px;
        margin: 0 auto;
      }

      .content {
        display: grid;
        grid-template-columns: 1fr;
        margin-bottom: 40px;
      }

      .demo-section {
        background: white;
        border-radius: 15px;
        padding: 30px;
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        margin-bottom: 30px;
      }

      .explanation-section {
        background: white;
        border-radius: 15px;
        padding: 30px;
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
      }

      h2 {
        color: #2c3e50;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 3px solid #e67e22;
      }

      h3 {
        color: #2c3e50;
        margin: 25px 0 15px 0;
      }

      .demo-container {
        position: relative;
        width: 100%;
        height: 500px;
        border: 2px solid #34495e;
        margin: 25px 0;
        background: #ecf0f1;
        padding: 30px;
        border-radius: 10px;
        overflow: hidden;
      }

      .target-element {
        width: 350px;
        height: 280px;
        padding: 25px;
        margin: 20px auto;
        border: 12px solid #e67e22;
        background: #3498db33;
        border-radius: 8px;
        position: relative;
        overflow: auto;
        transition: all 0.3s ease;
      }

      .content-area {
        width: 100%;
        min-height: 600px;
        background: linear-gradient(45deg, #9b59b633, #e67e2233);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        text-align: center;
        padding: 20px;
        border: 2px dashed #9b59b6;
        border-radius: 6px;
      }

      .content-block {
        width: 90%;
        padding: 15px;
        margin: 10px 0;
        background: rgba(255, 255, 255, 0.7);
        border-radius: 6px;
        border-left: 4px solid #3498db;
      }

      .dimension-visualization {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        pointer-events: none;
      }

      .clientHeight-highlight {
        position: absolute;
        left: 0;
        right: 0;
        background: rgba(230, 126, 34, 0.3);
        border: 2px solid #e67e22;
        transition: height 0.3s ease, top 0.3s ease;
      }

      .dimension-label {
        position: absolute;
        background: rgba(255, 255, 255, 0.9);
        padding: 6px 12px;
        border-radius: 4px;
        font-size: 0.9rem;
        font-weight: bold;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        white-space: nowrap;
      }

      .controls {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        margin: 20px 0;
      }

      button {
        padding: 12px 15px;
        background: #e67e22;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.9rem;
        font-weight: 600;
      }

      button:hover {
        background: #d35400;
        transform: translateY(-2px);
      }

      button.secondary {
        background: #3498db;
      }

      button.secondary:hover {
        background: #2980b9;
      }

      .property-display {
        background: #2c3e50;
        color: white;
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
      }

      .property-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 10px 0;
        padding: 8px 12px;
        background: #34495e;
        border-radius: 6px;
      }

      .property-name {
        font-weight: bold;
        font-size: 1.1rem;
      }

      .property-value {
        font-family: "Courier New", monospace;
        font-size: 1.2rem;
        color: #f1c40f;
        font-weight: bold;
      }

      .style-controls {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
      }

      .control-group {
        margin: 15px 0;
      }

      .control-label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #2c3e50;
      }

      .range-slider {
        width: 100%;
        height: 6px;
        border-radius: 3px;
        background: #ddd;
        outline: none;
        -webkit-appearance: none;
      }

      .range-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #e67e22;
        cursor: pointer;
      }

      .range-value {
        text-align: center;
        font-weight: bold;
        color: #e67e22;
        margin-top: 5px;
      }

      .comparison-table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        background: white;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .comparison-table th {
        background: #e67e22;
        color: white;
        padding: 12px 15px;
        text-align: left;
      }

      .comparison-table td {
        padding: 10px 15px;
        border-bottom: 1px solid #ecf0f1;
      }

      .comparison-table tr:nth-child(even) {
        background: #f8f9fa;
      }

      .code-block {
        background: #2c3e50;
        color: #ecf0f1;
        padding: 20px;
        border-radius: 10px;
        font-family: "Courier New", monospace;
        margin: 20px 0;
        overflow-x: auto;
        font-size: 0.9rem;
        line-height: 1.5;

        white-space: pre;
      }

      .special-cases {
        background: #fff9e6;
        padding: 20px;
        border-radius: 10px;
        border-left: 4px solid #f1c40f;
        margin: 20px 0;
      }

      .case-example {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        margin: 10px 0;
        border: 1px solid #e9ecef;
      }

      .scrollbar-demo {
        background: #fef9e7;
        padding: 15px;
        border-radius: 8px;
        margin: 15px 0;
        border: 2px solid #f1c40f;
      }

      .element-breakdown {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 20px 0;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 10px;
      }

      .breakdown-layer {
        width: 250px;
        padding: 10px;
        text-align: center;
        margin: 2px 0;
        border: 2px solid;
        border-radius: 4px;
        font-weight: bold;
        font-size: 0.9rem;
      }

      .margin-layer {
        border-color: #e74c3c;
        background: #e74c3c22;
        color: #e74c3c;
      }
      .border-layer {
        border-color: #e67e22;
        background: #e67e2222;
        color: #e67e22;
      }
      .padding-layer {
        border-color: #3498db;
        background: #3498db22;
        color: #3498db;
      }
      .content-layer {
        border-color: #9b59b6;
        background: #9b59b622;
        color: #9b59b6;
      }

      .height-comparison {
        display: flex;
        justify-content: space-around;
        margin: 20px 0;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 8px;
      }

      .height-item {
        text-align: center;
        padding: 10px;
      }

      .height-value {
        font-size: 1.2rem;
        font-weight: bold;
        color: #2c3e50;
      }

      .height-label {
        font-size: 0.8rem;
        color: #7f8c8d;
        margin-top: 5px;
      }

      @media (max-width: 968px) {
        .content {
          grid-template-columns: 1fr;
        }

        .controls {
          grid-template-columns: 1fr;
        }

        .height-comparison {
          flex-direction: column;
          gap: 10px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>clientHeight å±æ€§è¯¦è§£</h1>
        <p class="subtitle">æ·±å…¥ç†è§£ clientHeight çš„è®¡ç®—æ–¹å¼ã€åº”ç”¨åœºæ™¯å’Œç‰¹æ®Šè¡Œä¸º</p>
      </header>

      <div class="content">
        <div class="demo-section">
          <h2>äº¤äº’æ¼”ç¤º</h2>
          <p>è°ƒæ•´å…ƒç´ æ ·å¼ï¼Œè§‚å¯Ÿ clientHeight å€¼çš„å˜åŒ–</p>

          <div class="demo-container">
            <div class="target-element" id="targetElement">
              <div class="dimension-visualization" id="dimensionVisualization">
                <div class="clientHeight-highlight" id="clientHeightHighlight"></div>
              </div>
              <div class="content-area" id="contentArea">
                <div class="content-block">
                  <h3>ç›®æ ‡å…ƒç´ </h3>
                  <p>clientHeight = å†…å®¹é«˜åº¦ + ä¸Šä¸‹å†…è¾¹è·</p>
                  <p><strong>ä¸åŒ…å«è¾¹æ¡†å’Œæ»šåŠ¨æ¡</strong></p>
                </div>
                <div class="scrollbar-demo">
                  <p>è¿™ä¸ªåŒºåŸŸæ¯”å®¹å™¨é«˜ï¼Œç”¨äºæ¼”ç¤ºæ»šåŠ¨æ¡</p>
                  <p>å°è¯•ä¸Šä¸‹æ»šåŠ¨è§‚å¯Ÿ clientHeight è¡Œä¸º</p>
                </div>
                <div class="content-block">
                  <p>æ›´å¤šå†…å®¹...</p>
                  <p>clientHeight è¡¨ç¤ºå¯è§†åŒºåŸŸçš„é«˜åº¦</p>
                </div>
                <div class="content-block">
                  <p>é¢å¤–å†…å®¹å—</p>
                  <p>scrollHeight è¡¨ç¤ºæ€»å†…å®¹é«˜åº¦</p>
                </div>
              </div>
            </div>
          </div>

          <div class="element-breakdown">
            <h4>å…ƒç´ ç›’æ¨¡å‹é«˜åº¦åˆ†è§£</h4>
            <div class="breakdown-layer margin-layer">ä¸Šè¾¹è·</div>
            <div class="breakdown-layer border-layer">ä¸Šè¾¹æ¡†</div>
            <div class="breakdown-layer padding-layer">ä¸Šå†…è¾¹è· â† clientHeight åŒ…å«</div>
            <div class="breakdown-layer content-layer">å†…å®¹é«˜åº¦ â† clientHeight åŒ…å«</div>
            <div class="breakdown-layer padding-layer">ä¸‹å†…è¾¹è· â† clientHeight åŒ…å«</div>
            <div class="breakdown-layer border-layer">ä¸‹è¾¹æ¡†</div>
            <div class="breakdown-layer margin-layer">ä¸‹è¾¹è·</div>
          </div>

          <div class="height-comparison">
            <div class="height-item">
              <div class="height-value" id="clientHeightDisplay">0px</div>
              <div class="height-label">clientHeight</div>
            </div>
            <div class="height-item">
              <div class="height-value" id="offsetHeightDisplay">0px</div>
              <div class="height-label">offsetHeight</div>
            </div>
            <div class="height-item">
              <div class="height-value" id="scrollHeightDisplay">0px</div>
              <div class="height-label">scrollHeight</div>
            </div>
          </div>

          <div class="style-controls">
            <div class="control-group">
              <label class="control-label">ä¸Šä¸‹å†…è¾¹è· (Padding):</label>
              <input type="range" min="0" max="50" value="25" class="range-slider" id="paddingSlider" />
              <div class="range-value" id="paddingValue">25px</div>
            </div>

            <div class="control-group">
              <label class="control-label">ä¸Šä¸‹è¾¹æ¡† (Border):</label>
              <input type="range" min="0" max="30" value="12" class="range-slider" id="borderSlider" />
              <div class="range-value" id="borderValue">12px</div>
            </div>

            <div class="control-group">
              <label class="control-label">å…ƒç´ é«˜åº¦:</label>
              <input type="range" min="200" max="500" value="280" class="range-slider" id="elementHeightSlider" />
              <div class="range-value" id="elementHeightValue">280px</div>
            </div>
          </div>

          <div class="controls">
            <button onclick="toggleScrollbar()">åˆ‡æ¢æ»šåŠ¨æ¡</button>
            <button onclick="changeContentHeight()">æ”¹å˜å†…å®¹é«˜åº¦</button>
            <button class="secondary" onclick="addContentBlock()">æ·»åŠ å†…å®¹å—</button>
            <button class="secondary" onclick="resetAll()">é‡ç½®æ‰€æœ‰</button>
          </div>

          <div class="property-display">
            <h3 style="color: white; margin-top: 0">é«˜åº¦å±æ€§å¯¹æ¯”</h3>
            <div class="property-item">
              <span class="property-name">clientHeight:</span>
              <span class="property-value" id="clientHeightVal">0px</span>
            </div>
            <div class="property-item">
              <span class="property-name">offsetHeight:</span>
              <span class="property-value" id="offsetHeightVal">0px</span>
            </div>
            <div class="property-item">
              <span class="property-name">scrollHeight:</span>
              <span class="property-value" id="scrollHeightVal">0px</span>
            </div>
            <div class="property-item">
              <span class="property-name">CSS height:</span>
              <span class="property-value" id="cssHeightVal">0px</span>
            </div>
            <div class="property-item">
              <span class="property-name">æ»šåŠ¨æ¡é«˜åº¦å½±å“:</span>
              <span class="property-value" id="scrollbarEffectVal">0px</span>
            </div>
          </div>
        </div>

        <div class="explanation-section">
          <h2>clientHeight è¯¦è§£</h2>

          <div class="special-cases">
            <h3>ğŸ“Œ clientHeight æ ¸å¿ƒå®šä¹‰</h3>
            <p><strong>clientHeight = å†…å®¹é«˜åº¦ + ä¸Šä¸‹å†…è¾¹è· - æ°´å¹³æ»šåŠ¨æ¡é«˜åº¦</strong></p>
            <p>è¡¨ç¤ºå…ƒç´ å†…éƒ¨å¯è§†å†…å®¹çš„é«˜åº¦ï¼Œä¸åŒ…æ‹¬è¾¹æ¡†å’Œæ»šåŠ¨æ¡ã€‚</p>
          </div>

          <h3>è®¡ç®—å…¬å¼</h3>
          <div class="code-block">
// clientHeight è®¡ç®—å…¬å¼
element.clientHeight = element.height + padding-top + padding-bottom - horizontal-scrollbar-height

// å®é™…è®¡ç®—ç¤ºä¾‹
const element = document.getElementById('example');
const style = window.getComputedStyle(element);

const contentHeight = parseInt(style.height) || element.offsetHeight;
const paddingTop = parseInt(style.paddingTop);
const paddingBottom = parseInt(style.paddingBottom);
const scrollbarHeight = element.offsetHeight - element.clientHeight - 
                       parseInt(style.borderTopWidth) - parseInt(style.borderBottomWidth);

console.log('clientHeight:', element.clientHeight);
console.log('æ‰‹åŠ¨è®¡ç®—:', contentHeight + paddingTop + paddingBottom - scrollbarHeight);
          </div>

          <h3>ä¸å…¶ä»–é«˜åº¦å±æ€§çš„å¯¹æ¯”</h3>
          <table class="comparison-table">
            <thead>
              <tr>
                <th>å±æ€§</th>
                <th>åŒ…å«å†…å®¹</th>
                <th>ä¸åŒ…å«å†…å®¹</th>
                <th>å…¸å‹ç”¨é€”</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>clientHeight</strong></td>
                <td>å†…å®¹ + ä¸Šä¸‹å†…è¾¹è·</td>
                <td>è¾¹æ¡†ã€æ»šåŠ¨æ¡</td>
                <td>è·å–å¯è§†å†…å®¹åŒºåŸŸé«˜åº¦</td>
              </tr>
              <tr>
                <td>offsetHeight</td>
                <td>å†…å®¹ + å†…è¾¹è· + è¾¹æ¡† + æ»šåŠ¨æ¡</td>
                <td>å¤–è¾¹è·</td>
                <td>è·å–å…ƒç´ æ•´ä½“é«˜åº¦</td>
              </tr>
              <tr>
                <td>scrollHeight</td>
                <td>å…¨éƒ¨å†…å®¹ + ä¸Šä¸‹å†…è¾¹è·</td>
                <td>è¾¹æ¡†ã€æ»šåŠ¨æ¡</td>
                <td>è·å–å†…å®¹æ€»é«˜åº¦</td>
              </tr>
              <tr>
                <td>getComputedStyle().height</td>
                <td>CSSè®¾ç½®çš„é«˜åº¦</td>
                <td>å†…è¾¹è·ã€è¾¹æ¡†</td>
                <td>è·å–CSSé«˜åº¦å€¼</td>
              </tr>
            </tbody>
          </table>

          <h3>ç‰¹æ®Šæƒ…å†µå’Œæ³¨æ„äº‹é¡¹</h3>

          <div class="case-example">
            <h4>æƒ…å†µ 1: æ»šåŠ¨æ¡çš„å½±å“</h4>
            <p>å½“å­˜åœ¨æ°´å¹³æ»šåŠ¨æ¡æ—¶ï¼ŒclientHeight ä¼šè‡ªåŠ¨å‡å»æ»šåŠ¨æ¡é«˜åº¦ï¼š</p>
            <div class="code-block">
// æœ‰æ°´å¹³æ»šåŠ¨æ¡çš„æƒ…å†µ
element.style.overflowX = 'auto';
console.log('æœ‰æ°´å¹³æ»šåŠ¨æ¡ - clientHeight:', element.clientHeight);
console.log('æœ‰æ°´å¹³æ»šåŠ¨æ¡ - offsetHeight:', element.offsetHeight);

// æ— æ»šåŠ¨æ¡çš„æƒ…å†µ  
element.style.overflow = 'hidden';
console.log('æ— æ»šåŠ¨æ¡ - clientHeight:', element.clientHeight);
console.log('æ— æ»šåŠ¨æ¡ - offsetHeight:', element.offsetHeight);

// æ»šåŠ¨æ¡é«˜åº¦å½±å“è®¡ç®—
const scrollbarEffect = element.offsetHeight - element.clientHeight - 
                       element.clientTop - element.clientBottom;
            </div>
          </div>

          <div class="case-example">
            <h4>æƒ…å†µ 2: å†…è”å…ƒç´ å’Œéšè—å…ƒç´ </h4>
            <p>å†…è”å…ƒç´ å’Œ display: none çš„å…ƒç´  clientHeight ä¸º 0ï¼š</p>
            <div class="code-block">
// å†…è”å…ƒç´ 
const span = document.createElement('span');
span.textContent = 'å†…è”å…ƒç´ ';
console.log('å†…è”å…ƒç´  clientHeight:', span.clientHeight); // 0

// éšè—å…ƒç´ 
element.style.display = 'none';
console.log('éšè—å…ƒç´  clientHeight:', element.clientHeight); // 0

element.style.display = 'block';
console.log('æ˜¾ç¤ºå…ƒç´  clientHeight:', element.clientHeight); // æ­£å¸¸å€¼
            </div>
          </div>

          <div class="case-example">
            <h4>æƒ…å†µ 3: ç™¾åˆ†æ¯”é«˜åº¦å’Œè‡ªåŠ¨é«˜åº¦</h4>
            <p>clientHeight å¯ä»¥æ­£ç¡®åæ˜ è®¡ç®—åçš„å®é™…é«˜åº¦ï¼š</p>
            <div class="code-block">
// ç™¾åˆ†æ¯”é«˜åº¦
element.style.height = '50%';
console.log('ç™¾åˆ†æ¯”é«˜åº¦ clientHeight:', element.clientHeight); // å®é™…è®¡ç®—å€¼

// è‡ªåŠ¨é«˜åº¦ï¼ˆç”±å†…å®¹å†³å®šï¼‰
element.style.height = 'auto';
console.log('è‡ªåŠ¨é«˜åº¦ clientHeight:', element.clientHeight); // å†…å®¹å®é™…é«˜åº¦ + å†…è¾¹è·

// min-height å’Œ max-height çš„å½±å“
element.style.minHeight = '200px';
element.style.maxHeight = '400px';
console.log('å—é™åˆ¶çš„ clientHeight:', element.clientHeight); // åœ¨ min/max èŒƒå›´å†…
            </div>
          </div>

          <h3>å®é™…åº”ç”¨åœºæ™¯</h3>
          <div class="code-block">
// åº”ç”¨ 1: æ— é™æ»šåŠ¨åŠ è½½
function checkInfiniteScroll(container) {
    const scrollBottom = container.scrollTop + container.clientHeight;
    const threshold = 100; // è·ç¦»åº•éƒ¨100pxæ—¶åŠ è½½
    
    if (scrollBottom >= container.scrollHeight - threshold) {
        loadMoreContent();
    }
}

// åº”ç”¨ 2: è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–
function calculateVisibleItems(container, itemHeight) {
    const visibleHeight = container.clientHeight;
    const scrollTop = container.scrollTop;
    
    const startIndex = Math.floor(scrollTop / itemHeight);
    const endIndex = Math.ceil((scrollTop + visibleHeight) / itemHeight);
    
    return { startIndex, endIndex, visibleCount: endIndex - startIndex };
}

// åº”ç”¨ 3: å“åº”å¼é«˜åº¦è°ƒæ•´
function adjustElementHeight(element) {
    const viewportHeight = window.innerHeight || document.documentElement.clientHeight;
    const maxHeight = viewportHeight * 0.8; // æœ€å¤§ä¸ºè§†å£çš„80%
    
    element.style.maxHeight = maxHeight + 'px';
}

// åº”ç”¨ 4: æ»šåŠ¨è¿›åº¦æŒ‡ç¤ºå™¨
function updateScrollProgress(container, progressBar) {
    const scrollableHeight = container.scrollHeight - container.clientHeight;
    const progress = (container.scrollTop / scrollableHeight) * 100;
    
    progressBar.style.width = progress + '%';
}

// åº”ç”¨ 5: æ¨¡æ€æ¡†å‚ç›´å±…ä¸­
function centerModalVertically(modal) {
    const viewportHeight = document.documentElement.clientHeight;
    const modalHeight = modal.offsetHeight;
    
    modal.style.top = (viewportHeight - modalHeight) / 2 + 'px';
}

// åº”ç”¨ 6: è‡ªé€‚åº”æ–‡æœ¬åŒºåŸŸ
function autoResizeTextarea(textarea) {
    // é‡ç½®é«˜åº¦ä»¥ä¾¿æ­£ç¡®è®¡ç®— scrollHeight
    textarea.style.height = 'auto';
    
    // è®¾ç½®æ–°é«˜åº¦ï¼Œä½†ä¸è¶…è¿‡æœ€å¤§é«˜åº¦
    const maxHeight = 300;
    const newHeight = Math.min(textarea.scrollHeight, maxHeight);
    
    textarea.style.height = newHeight + 'px';
    textarea.style.overflowY = newHeight >= maxHeight ? 'auto' : 'hidden';
}

// åº”ç”¨ 7: åˆ†é¡µå™¨è®¡ç®—
function calculatePagination(container, itemHeight) {
    const visibleItems = Math.floor(container.clientHeight / itemHeight);
    const totalItems = Math.ceil(container.scrollHeight / itemHeight);
    const totalPages = Math.ceil(totalItems / visibleItems);
    
    return { visibleItems, totalItems, totalPages };
}
          </div>

          <h3>è§†å£ç›¸å…³çš„ clientHeight</h3>
          <div class="code-block">
// è·å–è§†å£é«˜åº¦ï¼ˆè·¨æµè§ˆå™¨å…¼å®¹ï¼‰
function getViewportHeight() {
    return window.innerHeight || 
           document.documentElement.clientHeight || 
           document.body.clientHeight;
}

// æ£€æµ‹å…ƒç´ æ˜¯å¦åœ¨è§†å£å†…
function isElementInViewport(element) {
    const rect = element.getBoundingClientRect();
    const viewportHeight = getViewportHeight();
    
    return (
        rect.top >= 0 &&
        rect.bottom <= viewportHeight
    );
}

// æ£€æµ‹å…ƒç´ æ˜¯å¦éƒ¨åˆ†åœ¨è§†å£å†…
function isElementPartiallyInViewport(element) {
    const rect = element.getBoundingClientRect();
    const viewportHeight = getViewportHeight();
    
    return (
        rect.top < viewportHeight &&
        rect.bottom > 0
    );
}

// è®¡ç®—å…ƒç´ è¿›å…¥è§†å£çš„ç™¾åˆ†æ¯”
function getElementVisibilityPercentage(element) {
    const rect = element.getBoundingClientRect();
    const viewportHeight = getViewportHeight();
    
    const visibleTop = Math.max(0, rect.top);
    const visibleBottom = Math.min(viewportHeight, rect.bottom);
    const visibleHeight = Math.max(0, visibleBottom - visibleTop);
    
    return (visibleHeight / rect.height) * 100;
}
          </div>
        </div>
      </div>
    </div>

    <script>
      // è·å–DOMå…ƒç´ 
      const targetElement = document.getElementById("targetElement");
      const contentArea = document.getElementById("contentArea");
      const clientHeightHighlight = document.getElementById("clientHeightHighlight");

      // è·å–æ§åˆ¶å…ƒç´ 
      const paddingSlider = document.getElementById("paddingSlider");
      const borderSlider = document.getElementById("borderSlider");
      const elementHeightSlider = document.getElementById("elementHeightSlider");

      // è·å–æ˜¾ç¤ºå…ƒç´ 
      const clientHeightVal = document.getElementById("clientHeightVal");
      const offsetHeightVal = document.getElementById("offsetHeightVal");
      const scrollHeightVal = document.getElementById("scrollHeightVal");
      const cssHeightVal = document.getElementById("cssHeightVal");
      const scrollbarEffectVal = document.getElementById("scrollbarEffectVal");
      const paddingValue = document.getElementById("paddingValue");
      const borderValue = document.getElementById("borderValue");
      const elementHeightValue = document.getElementById("elementHeightValue");

      // é«˜åº¦æ¯”è¾ƒæ˜¾ç¤º
      const clientHeightDisplay = document.getElementById("clientHeightDisplay");
      const offsetHeightDisplay = document.getElementById("offsetHeightDisplay");
      const scrollHeightDisplay = document.getElementById("scrollHeightDisplay");

      // æ›´æ–°å±æ€§æ˜¾ç¤º
      function updateProperties() {
        const clientHeight = targetElement.clientHeight;
        const offsetHeight = targetElement.offsetHeight;
        const scrollHeight = targetElement.scrollHeight;
        const computedStyle = window.getComputedStyle(targetElement);

        clientHeightVal.textContent = clientHeight + "px";
        offsetHeightVal.textContent = offsetHeight + "px";
        scrollHeightVal.textContent = scrollHeight + "px";
        cssHeightVal.textContent = computedStyle.height;

        // è®¡ç®—æ»šåŠ¨æ¡å½±å“
        const scrollbarEffect = offsetHeight - clientHeight - parseInt(computedStyle.borderTopWidth) - parseInt(computedStyle.borderBottomWidth);
        scrollbarEffectVal.textContent = Math.max(0, scrollbarEffect) + "px";

        // æ›´æ–°é«˜åº¦æ¯”è¾ƒæ˜¾ç¤º
        clientHeightDisplay.textContent = clientHeight + "px";
        offsetHeightDisplay.textContent = offsetHeight + "px";
        scrollHeightDisplay.textContent = scrollHeight + "px";

        // æ›´æ–°å¯è§†åŒ–
        updateVisualization();
      }

      // æ›´æ–°å¯è§†åŒ–
      function updateVisualization() {
        const clientHeight = targetElement.clientHeight;
        const clientTop = targetElement.clientTop;

        clientHeightHighlight.style.height = clientHeight + "px";
        clientHeightHighlight.style.top = clientTop + "px";

        // æ›´æ–°æ ‡ç­¾
        updateDimensionLabels();
      }

      // æ›´æ–°å°ºå¯¸æ ‡ç­¾
      function updateDimensionLabels() {
        // æ¸…é™¤æ—§æ ‡ç­¾
        document.querySelectorAll(".dimension-label").forEach(label => label.remove());

        const rect = targetElement.getBoundingClientRect();
        const containerRect = targetElement.parentElement.getBoundingClientRect();

        const relativeTop = rect.top - containerRect.top;
        const relativeLeft = rect.left - containerRect.left;
        const clientHeight = targetElement.clientHeight;
        const clientTop = targetElement.clientTop;

        // clientHeight æ ‡ç­¾
        const heightLabel = document.createElement("div");
        heightLabel.className = "dimension-label";
        heightLabel.style.top = relativeTop + clientTop + clientHeight / 2 - 10 + "px";
        heightLabel.style.left = relativeLeft - 100 + "px";
        heightLabel.textContent = `clientHeight: ${clientHeight}px`;
        targetElement.parentElement.appendChild(heightLabel);

        // clientTop æ ‡ç­¾
        const topLabel = document.createElement("div");
        topLabel.className = "dimension-label";
        topLabel.style.top = relativeTop + clientTop / 2 - 10 + "px";
        topLabel.style.left = relativeLeft + 20 + "px";
        topLabel.textContent = `clientTop: ${clientTop}px`;
        targetElement.parentElement.appendChild(topLabel);
      }

      // æ§åˆ¶å‡½æ•°
      function toggleScrollbar() {
        if (targetElement.style.overflow === "hidden") {
          targetElement.style.overflow = "auto";
        } else {
          targetElement.style.overflow = "hidden";
        }
        updateProperties();
      }

      function changeContentHeight() {
        const currentHeight = parseInt(targetElement.style.height) || 280;
        const newHeight = currentHeight === 280 ? 350 : 280;
        targetElement.style.height = newHeight + "px";
        elementHeightSlider.value = newHeight;
        elementHeightValue.textContent = newHeight + "px";
        updateProperties();
      }

      function addContentBlock() {
        const newBlock = document.createElement("div");
        newBlock.className = "content-block";
        newBlock.innerHTML = `
                <p>æ–°å¢å†…å®¹å— #${Date.now().toString().slice(-4)}</p>
                <p>è¿™å¢åŠ äº†å†…å®¹çš„æ€»ä½“é«˜åº¦</p>
            `;
        contentArea.appendChild(newBlock);
        updateProperties();
      }

      function resetAll() {
        targetElement.style.padding = "25px";
        targetElement.style.borderWidth = "12px";
        targetElement.style.height = "";
        targetElement.style.overflow = "auto";
        contentArea.innerHTML = `
                <div class="content-block">
                    <h3>ç›®æ ‡å…ƒç´ </h3>
                    <p>clientHeight = å†…å®¹é«˜åº¦ + ä¸Šä¸‹å†…è¾¹è·</p>
                    <p><strong>ä¸åŒ…å«è¾¹æ¡†å’Œæ»šåŠ¨æ¡</strong></p>
                </div>
                <div class="scrollbar-demo">
                    <p>è¿™ä¸ªåŒºåŸŸæ¯”å®¹å™¨é«˜ï¼Œç”¨äºæ¼”ç¤ºæ»šåŠ¨æ¡</p>
                    <p>å°è¯•ä¸Šä¸‹æ»šåŠ¨è§‚å¯Ÿ clientHeight è¡Œä¸º</p>
                </div>
                <div class="content-block">
                    <p>æ›´å¤šå†…å®¹...</p>
                    <p>clientHeight è¡¨ç¤ºå¯è§†åŒºåŸŸçš„é«˜åº¦</p>
                </div>
                <div class="content-block">
                    <p>é¢å¤–å†…å®¹å—</p>
                    <p>scrollHeight è¡¨ç¤ºæ€»å†…å®¹é«˜åº¦</p>
                </div>
            `;

        paddingSlider.value = 25;
        borderSlider.value = 12;
        elementHeightSlider.value = 280;
        paddingValue.textContent = "25px";
        borderValue.textContent = "12px";
        elementHeightValue.textContent = "280px";

        updateProperties();
      }

      // äº‹ä»¶ç›‘å¬
      paddingSlider.addEventListener("input", function () {
        const padding = parseInt(this.value);
        targetElement.style.padding = padding + "px";
        paddingValue.textContent = padding + "px";
        updateProperties();
      });

      borderSlider.addEventListener("input", function () {
        const border = parseInt(this.value);
        targetElement.style.borderWidth = border + "px";
        borderValue.textContent = border + "px";
        updateProperties();
      });

      elementHeightSlider.addEventListener("input", function () {
        const height = parseInt(this.value);
        targetElement.style.height = height + "px";
        elementHeightValue.textContent = height + "px";
        updateProperties();
      });

      // ç›‘å¬æ»šåŠ¨äº‹ä»¶æ¥æ¼”ç¤º clientHeight ä¸å˜æ€§
      targetElement.addEventListener("scroll", function () {
        console.log("æ»šåŠ¨ä¸­ - clientHeight:", this.clientHeight, "scrollTop:", this.scrollTop);
      });

      // åˆå§‹åŒ–
      updateProperties();

      // æ§åˆ¶å°æ¼”ç¤º
      setTimeout(() => {
        console.log("=== clientHeight å±æ€§æ¼”ç¤º ===");
        console.log("clientHeight:", targetElement.clientHeight, "px");
        console.log("offsetHeight:", targetElement.offsetHeight, "px");
        console.log("scrollHeight:", targetElement.scrollHeight, "px");

        const computedStyle = window.getComputedStyle(targetElement);
        console.log("CSS height:", computedStyle.height);
        console.log("Padding:", computedStyle.padding);
        console.log("Border:", computedStyle.borderWidth);

        console.log("\nğŸ” clientHeight è®¡ç®—éªŒè¯:");
        const contentHeight = parseInt(computedStyle.height) || targetElement.offsetHeight;
        const paddingTop = parseInt(computedStyle.paddingTop);
        const paddingBottom = parseInt(computedStyle.paddingBottom);
        const scrollbarEffect = targetElement.offsetHeight - targetElement.clientHeight - parseInt(computedStyle.borderTopWidth) - parseInt(computedStyle.borderBottomWidth);

        console.log("è®¡ç®—å€¼:", contentHeight + paddingTop + paddingBottom - scrollbarEffect, "px");
        console.log("å®é™… clientHeight:", targetElement.clientHeight, "px");
        console.log("æ˜¯å¦ç›¸ç­‰:", contentHeight + paddingTop + paddingBottom - scrollbarEffect === targetElement.clientHeight);

        console.log("\nğŸŒ è§†å£ç›¸å…³é«˜åº¦:");
        console.log("window.innerHeight:", window.innerHeight);
        console.log("document.documentElement.clientHeight:", document.documentElement.clientHeight);
        console.log("document.body.clientHeight:", document.body.clientHeight);
      }, 1000);
    </script>
  </body>
</html>
