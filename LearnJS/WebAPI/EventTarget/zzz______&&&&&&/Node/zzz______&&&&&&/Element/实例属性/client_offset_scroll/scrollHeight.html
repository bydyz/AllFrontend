<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>scrollHeight å±æ€§è¯¦è§£</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        color: #333;
        line-height: 1.6;
        padding: 20px;
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      header {
        text-align: center;
        margin-bottom: 40px;
        padding: 30px;
        background: white;
        border-radius: 15px;
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
      }

      h1 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 2.5rem;
      }

      .subtitle {
        color: #7f8c8d;
        font-size: 1.3rem;
        max-width: 800px;
        margin: 0 auto;
      }

      .content {
        display: grid;
        grid-template-columns: 100%;
        margin-bottom: 40px;
      }

      .demo-section {
        background: white;
        border-radius: 15px;
        padding: 30px;
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        margin-bottom: 40px;
      }

      .explanation-section {
        background: white;
        border-radius: 15px;
        padding: 30px;
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
      }

      h2 {
        color: #2c3e50;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 3px solid #8e44ad;
      }

      h3 {
        color: #2c3e50;
        margin: 25px 0 15px 0;
      }

      .demo-container {
        position: relative;
        width: 100%;
        height: 400px;
        border: 2px solid #34495e;
        margin: 25px 0;
        background: #ecf0f1;
        padding: 20px;
        border-radius: 10px;
        overflow: hidden;
      }

      .scroll-element {
        width: 100%;
        height: 100%;
        overflow: auto;
        border: 2px solid #8e44ad;
        border-radius: 8px;
        background: white;
        position: relative;
      }

      .scroll-content {
        padding: 20px;
        background: linear-gradient(180deg, #3498db11 0%, #2ecc7111 20%, #e74c3c11 40%, #f39c1211 60%, #9b59b611 80%, #1abc9c11 100%);
      }

      .content-section {
        min-height: 180px;
        margin: 20px 0;
        padding: 20px;
        border-radius: 8px;
        border: 2px solid;
        position: relative;
      }

      .section-1 {
        background: #3498db33;
        border-color: #3498db;
      }
      .section-2 {
        background: #2ecc7133;
        border-color: #2ecc71;
      }
      .section-3 {
        background: #e74c3c33;
        border-color: #e74c3c;
      }
      .section-4 {
        background: #f39c1233;
        border-color: #f39c12;
      }
      .section-5 {
        background: #9b59b633;
        border-color: #9b59b6;
      }

      .dimension-visualization {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        pointer-events: none;
        z-index: 5;
      }

      .scrollHeight-highlight {
        position: absolute;
        left: 0;
        right: 0;
        background: rgba(142, 68, 173, 0.2);
        border: 2px dashed #8e44ad;
        transition: height 0.3s ease;
      }

      .clientHeight-highlight {
        position: absolute;
        left: 0;
        right: 0;
        background: rgba(52, 152, 219, 0.2);
        border: 2px solid #3498db;
        height: 100%;
      }

      .dimension-label {
        position: absolute;
        background: rgba(255, 255, 255, 0.95);
        padding: 6px 12px;
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: bold;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        white-space: nowrap;
      }

      .scroll-indicator {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(142, 68, 173, 0.9);
        color: white;
        padding: 8px 12px;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: bold;
        z-index: 10;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      }

      .controls {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
        margin: 20px 0;
      }

      button {
        padding: 12px 15px;
        background: #8e44ad;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.9rem;
        font-weight: 600;
      }

      button:hover {
        background: #7d3c98;
        transform: translateY(-2px);
      }

      button.secondary {
        background: #3498db;
      }

      button.secondary:hover {
        background: #2980b9;
      }

      .property-display {
        background: #2c3e50;
        color: white;
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
      }

      .property-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 10px 0;
        padding: 8px 12px;
        background: #34495e;
        border-radius: 6px;
      }

      .property-name {
        font-weight: bold;
        font-size: 1.1rem;
      }

      .property-value {
        font-family: "Courier New", monospace;
        font-size: 1.2rem;
        color: #f1c40f;
        font-weight: bold;
      }

      .content-controls {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
      }

      .control-group {
        margin: 15px 0;
      }

      .control-label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #2c3e50;
      }

      .range-slider {
        width: 100%;
        height: 6px;
        border-radius: 3px;
        background: #ddd;
        outline: none;
        -webkit-appearance: none;
      }

      .range-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #8e44ad;
        cursor: pointer;
      }

      .range-value {
        text-align: center;
        font-weight: bold;
        color: #8e44ad;
        margin-top: 5px;
      }

      .height-comparison {
        display: flex;
        justify-content: space-around;
        margin: 20px 0;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 8px;
      }

      .height-item {
        text-align: center;
        padding: 10px;
        flex: 1;
      }

      .height-value {
        font-size: 1.2rem;
        font-weight: bold;
        color: #2c3e50;
      }

      .height-label {
        font-size: 0.8rem;
        color: #7f8c8d;
        margin-top: 5px;
      }

      .comparison-table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        background: white;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .comparison-table th {
        background: #8e44ad;
        color: white;
        padding: 12px 15px;
        text-align: left;
      }

      .comparison-table td {
        padding: 10px 15px;
        border-bottom: 1px solid #ecf0f1;
      }

      .comparison-table tr:nth-child(even) {
        background: #f8f9fa;
      }

      .code-block {
        background: #2c3e50;
        color: #ecf0f1;
        padding: 20px;
        border-radius: 10px;
        font-family: "Courier New", monospace;
        margin: 20px 0;
        overflow-x: auto;
        font-size: 0.9rem;
        line-height: 1.5;
        white-space: pre;
      }

      .special-cases {
        background: #fff9e6;
        padding: 20px;
        border-radius: 10px;
        border-left: 4px solid #f1c40f;
        margin: 20px 0;
      }

      .case-example {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        margin: 10px 0;
        border: 1px solid #e9ecef;
      }

      .auto-expand {
        background: #e8f6f3;
        padding: 15px;
        border-radius: 8px;
        margin: 15px 0;
        border: 2px solid #1abc9c;
      }

      .collapsible-section {
        background: #fef9e7;
        border-left: 4px solid #f1c40f;
        padding: 15px;
        margin: 10px 0;
        border-radius: 0 8px 8px 0;
      }

      .collapsible-content {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease;
      }

      .collapsible-content.expanded {
        max-height: 500px;
      }

      @media (max-width: 968px) {
        .content {
          grid-template-columns: 1fr;
        }

        .controls {
          grid-template-columns: 1fr;
        }

        .height-comparison {
          flex-direction: column;
          gap: 10px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>scrollHeight å±æ€§è¯¦è§£</h1>
        <p class="subtitle">æ·±å…¥ç†è§£ scrollHeight çš„è®¡ç®—æ–¹å¼ã€åº”ç”¨åœºæ™¯å’Œç‰¹æ®Šè¡Œä¸º</p>
      </header>

      <div class="content">
        <div class="demo-section">
          <h2>äº¤äº’æ¼”ç¤º</h2>
          <p>è°ƒæ•´å†…å®¹é«˜åº¦ï¼Œè§‚å¯Ÿ scrollHeight å€¼çš„å˜åŒ–</p>

          <div class="demo-container">
            <div class="scroll-element" id="scrollElement">
              <div class="scroll-indicator" id="scrollIndicator">scrollHeight: <span id="scrollHeightValue">1200</span>px</div>
              <div class="dimension-visualization" id="dimensionVisualization">
                <div class="scrollHeight-highlight" id="scrollHeightHighlight"></div>
                <div class="clientHeight-highlight" id="clientHeightHighlight"></div>
              </div>
              <div class="scroll-content" id="scrollContent">
                <div class="content-section section-1">
                  <h3>ç¬¬ä¸€éƒ¨åˆ†</h3>
                  <p>scrollHeight = å†…å®¹æ€»é«˜åº¦</p>
                  <p>åŒ…æ‹¬æ‰€æœ‰å¯è§å’Œä¸å¯è§å†…å®¹</p>
                  <div class="auto-expand">
                    <p>è¿™ä¸ªåŒºåŸŸæ¼”ç¤º scrollHeight çš„è®¡ç®—</p>
                    <p>å°è¯•è°ƒæ•´å†…å®¹é«˜åº¦è§‚å¯Ÿå˜åŒ–</p>
                  </div>
                </div>
                <div class="content-section section-2">
                  <h3>ç¬¬äºŒéƒ¨åˆ†</h3>
                  <p>åŒ…å«ä¸Šä¸‹å†…è¾¹è·</p>
                  <p>ä¸åŒ…å«è¾¹æ¡†å’Œå¤–è¾¹è·</p>
                  <div style="margin-top: 15px; padding: 15px; background: rgba(255, 255, 255, 0.5); border-radius: 6px">
                    <p>å†…è¾¹è·å½±å“ scrollHeight</p>
                    <p>ä½†è¾¹æ¡†ä¸å½±å“</p>
                  </div>
                </div>

                <div class="collapsible-section">
                  <h4>å¯æŠ˜å å†…å®¹åŒºåŸŸ</h4>
                  <p>ç‚¹å‡»å±•å¼€/æŠ˜å è§‚å¯Ÿ scrollHeight å˜åŒ–</p>
                  <button onclick="toggleCollapsible()" style="margin-top: 10px; padding: 8px 16px; background: #f39c12; color: white; border: none; border-radius: 4px; cursor: pointer">åˆ‡æ¢æŠ˜å çŠ¶æ€</button>
                  <div class="collapsible-content" id="collapsibleContent">
                    <div style="padding: 15px; background: rgba(255, 255, 255, 0.7); margin-top: 10px; border-radius: 4px">
                      <p>è¿™æ˜¯å¯æŠ˜å çš„å†…å®¹</p>
                      <p>å½“å†…å®¹æŠ˜å æ—¶ï¼ŒscrollHeight ä¼šå‡å°‘</p>
                      <p>å½“å†…å®¹å±•å¼€æ—¶ï¼ŒscrollHeight ä¼šå¢åŠ </p>
                      <p>è¿™ä¸ªç‰¹æ€§åœ¨å®ç°å¯æŠ˜å ç»„ä»¶æ—¶éå¸¸æœ‰ç”¨</p>
                    </div>
                  </div>
                </div>

                <div class="content-section section-3">
                  <h3>ç¬¬ä¸‰éƒ¨åˆ†</h3>
                  <p>ä¼ªå…ƒç´ åŒ…å«åœ¨å†…</p>
                  <p>::before å’Œ ::after</p>
                  <div style="margin-top: 15px; position: relative; padding: 15px; background: rgba(255, 255, 255, 0.5); border-radius: 6px">
                    <p>ä¼ªå…ƒç´ å†…å®¹</p>
                    <p>ä¹Ÿä¼šè®¡å…¥ scrollHeight</p>
                  </div>
                </div>
                <div class="content-section section-4">
                  <h3>ç¬¬å››éƒ¨åˆ†</h3>
                  <p>åŠ¨æ€å†…å®¹çš„å½±å“</p>
                  <p>å®æ—¶è®¡ç®—æ€»é«˜åº¦</p>
                  <div style="margin-top: 15px; padding: 15px; background: rgba(255, 255, 255, 0.5); border-radius: 6px">
                    <p>scrollHeight æ˜¯å®æ—¶è®¡ç®—çš„</p>
                    <p>åæ˜ å½“å‰çš„å†…å®¹æ€»é«˜åº¦</p>
                  </div>
                </div>
                <div class="content-section section-5">
                  <h3>ç¬¬äº”éƒ¨åˆ†</h3>
                  <p>overflow çš„å½±å“</p>
                  <p>hidden vs visible</p>
                  <div style="margin-top: 15px; padding: 15px; background: rgba(255, 255, 255, 0.5); border-radius: 6px">
                    <p>overflow ä¸å½±å“ scrollHeight</p>
                    <p>ä½†å½±å“æ˜¯å¦éœ€è¦æ»šåŠ¨æ¡</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="height-comparison">
            <div class="height-item">
              <div class="height-value" id="scrollHeightDisplay">1200px</div>
              <div class="height-label">scrollHeight</div>
            </div>
            <div class="height-item">
              <div class="height-value" id="clientHeightDisplay">400px</div>
              <div class="height-label">clientHeight</div>
            </div>
            <div class="height-item">
              <div class="height-value" id="offsetHeightDisplay">404px</div>
              <div class="height-label">offsetHeight</div>
            </div>
          </div>

          <div class="content-controls">
            <div class="control-group">
              <label class="control-label">å†…å®¹åŒºå—é«˜åº¦:</label>
              <input type="range" min="100" max="300" value="180" class="range-slider" id="sectionHeightSlider" />
              <div class="range-value" id="sectionHeightValue">180px</div>
            </div>

            <div class="control-group">
              <label class="control-label">å†…è¾¹è·:</label>
              <input type="range" min="10" max="50" value="20" class="range-slider" id="paddingSlider" />
              <div class="range-value" id="paddingValue">20px</div>
            </div>

            <div class="control-group">
              <label class="control-label">è¡Œé«˜:</label>
              <input type="range" min="1.2" max="2.5" value="1.6" step="0.1" class="range-slider" id="lineHeightSlider" />
              <div class="range-value" id="lineHeightValue">1.6</div>
            </div>
          </div>

          <div class="controls">
            <button onclick="addNewSection()">æ·»åŠ æ–°åŒºå—</button>
            <button onclick="removeSection()">ç§»é™¤åŒºå—</button>
            <button onclick="toggleOverflow()">åˆ‡æ¢overflow</button>
            <button class="secondary" onclick="addPseudoElement()">æ·»åŠ ä¼ªå…ƒç´ </button>
            <button class="secondary" onclick="toggleAutoExpand()">åˆ‡æ¢è‡ªåŠ¨æ‰©å±•</button>
            <button onclick="resetAll()">é‡ç½®æ‰€æœ‰</button>
          </div>

          <div class="property-display">
            <h3 style="color: white; margin-top: 0">é«˜åº¦å±æ€§å¯¹æ¯”</h3>
            <div class="property-item">
              <span class="property-name">scrollHeight:</span>
              <span class="property-value" id="scrollHeightVal">1200px</span>
            </div>
            <div class="property-item">
              <span class="property-name">clientHeight:</span>
              <span class="property-value" id="clientHeightVal">400px</span>
            </div>
            <div class="property-item">
              <span class="property-name">offsetHeight:</span>
              <span class="property-value" id="offsetHeightVal">404px</span>
            </div>
            <div class="property-item">
              <span class="property-name">æ˜¯å¦éœ€è¦å‚ç›´æ»šåŠ¨:</span>
              <span class="property-value" id="needsScrollVal">æ˜¯</span>
            </div>
            <div class="property-item">
              <span class="property-name">æº¢å‡ºé«˜åº¦:</span>
              <span class="property-value" id="overflowHeightVal">800px</span>
            </div>
          </div>
        </div>

        <div class="explanation-section">
          <h2>scrollHeight è¯¦è§£</h2>

          <div class="special-cases">
            <h3>ğŸ“Œ scrollHeight æ ¸å¿ƒå®šä¹‰</h3>
            <p><strong>scrollHeight = å…ƒç´ å†…å®¹çš„æ€»é«˜åº¦ï¼ŒåŒ…æ‹¬å› æº¢å‡ºè€Œä¸å¯è§çš„éƒ¨åˆ†</strong></p>
            <p>è¿™æ˜¯ä¸€ä¸ªåªè¯»å±æ€§ï¼Œè¿”å›å…ƒç´ å†…å®¹çš„å®Œæ•´é«˜åº¦ï¼Œä¸è€ƒè™‘å¯è§†åŒºåŸŸé™åˆ¶ã€‚</p>
          </div>

          <h3>åŸºæœ¬è®¡ç®—å…¬å¼</h3>
          <div class="code-block">
// scrollHeight åŒ…å«çš„å†…å®¹
element.scrollHeight = æ‰€æœ‰å†…å®¹é«˜åº¦ + ä¸Šä¸‹å†…è¾¹è·

// ä¸åŒ…å«çš„å†…å®¹
// - è¾¹æ¡† (border)
// - å¤–è¾¹è· (margin)
// - æ»šåŠ¨æ¡

// éªŒè¯è®¡ç®—
const element = document.getElementById('scrollElement');
const contentHeight = Array.from(element.children)
    .reduce((total, child) => total + child.offsetHeight, 0);
const paddingTop = parseInt(getComputedStyle(element).paddingTop);
const paddingBottom = parseInt(getComputedStyle(element).paddingBottom);

console.log('è®¡ç®—çš„æ€»é«˜åº¦:', contentHeight + paddingTop + paddingBottom);
console.log('å®é™…çš„scrollHeight:', element.scrollHeight);

// æ£€æµ‹æ˜¯å¦éœ€è¦å‚ç›´æ»šåŠ¨
const needsVerticalScroll = element.scrollHeight > element.clientHeight;
          </div>

          <h3>ä¸å…¶ä»–é«˜åº¦å±æ€§çš„å¯¹æ¯”</h3>
          <table class="comparison-table">
            <thead>
              <tr>
                <th>å±æ€§</th>
                <th>æè¿°</th>
                <th>åŒ…å«å†…å®¹</th>
                <th>ä¸åŒ…å«å†…å®¹</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>scrollHeight</strong></td>
                <td>å†…å®¹æ€»é«˜åº¦</td>
                <td>æ‰€æœ‰å†…å®¹ + å†…è¾¹è·</td>
                <td>è¾¹æ¡†ã€å¤–è¾¹è·ã€æ»šåŠ¨æ¡</td>
              </tr>
              <tr>
                <td>clientHeight</td>
                <td>å¯è§†åŒºåŸŸé«˜åº¦</td>
                <td>å¯è§†å†…å®¹ + å†…è¾¹è·</td>
                <td>è¾¹æ¡†ã€æ»šåŠ¨æ¡ã€æº¢å‡ºå†…å®¹</td>
              </tr>
              <tr>
                <td>offsetHeight</td>
                <td>å…ƒç´ æ•´ä½“é«˜åº¦</td>
                <td>å†…å®¹ + å†…è¾¹è· + è¾¹æ¡† + æ»šåŠ¨æ¡</td>
                <td>å¤–è¾¹è·</td>
              </tr>
              <tr>
                <td>getBoundingClientRect().height</td>
                <td>æ¸²æŸ“é«˜åº¦</td>
                <td>å†…å®¹ + å†…è¾¹è· + è¾¹æ¡†</td>
                <td>å¤–è¾¹è·ã€æ»šåŠ¨æ¡</td>
              </tr>
            </tbody>
          </table>

          <h3>ç‰¹æ®Šæƒ…å†µå’Œæ³¨æ„äº‹é¡¹</h3>

          <div class="case-example">
            <h4>æƒ…å†µ 1: å¯æŠ˜å å†…å®¹çš„å½±å“</h4>
            <p>åŠ¨æ€æ˜¾ç¤º/éšè—å†…å®¹ä¼šå®æ—¶å½±å“ scrollHeightï¼š</p>
            <div class="code-block">
// å¯æŠ˜å å†…å®¹å¯¹ scrollHeight çš„å½±å“
const collapsible = document.getElementById('collapsible');
const content = document.getElementById('collapsibleContent');

function toggleCollapse() {
    if (content.classList.contains('expanded')) {
        // æŠ˜å å†…å®¹
        content.classList.remove('expanded');
        content.style.maxHeight = '0';
    } else {
        // å±•å¼€å†…å®¹
        content.classList.add('expanded');
        content.style.maxHeight = content.scrollHeight + 'px';
    }
    
    // scrollHeight ä¼šå®æ—¶æ›´æ–°
    console.log('æŠ˜å åçš„ scrollHeight:', collapsible.scrollHeight);
}

// ä½¿ç”¨ scrollHeight å®ç°å¹³æ»‘åŠ¨ç”»
function smoothExpand(element) {
    const startHeight = element.clientHeight;
    const targetHeight = element.scrollHeight;
    
    element.style.transition = 'height 0.3s ease';
    element.style.height = startHeight + 'px';
    
    // å¼ºåˆ¶é‡æ’
    element.offsetHeight;
    
    element.style.height = targetHeight + 'px';
}
            </div>
          </div>

          <div class="case-example">
            <h4>æƒ…å†µ 2: æ–‡æœ¬å†…å®¹å’Œè¡Œé«˜</h4>
            <p>è¡Œé«˜å’Œæ–‡æœ¬æ¢è¡Œä¼šå½±å“ scrollHeightï¼š</p>
            <div class="code-block">
// è¡Œé«˜å¯¹ scrollHeight çš„å½±å“
const textElement = document.getElementById('text');
const lineHeight = parseFloat(getComputedStyle(textElement).lineHeight);
const clientHeight = textElement.clientHeight;

// è®¡ç®—å®é™…è¡Œæ•°
const actualLines = Math.ceil(textElement.scrollHeight / lineHeight);
const visibleLines = Math.floor(clientHeight / lineHeight);

console.log(`æ€»è¡Œæ•°: ${actualLines}, å¯è§è¡Œæ•°: ${visibleLines}`);

// æ£€æµ‹æ–‡æœ¬æ˜¯å¦è¢«æˆªæ–­
const isTextTruncated = textElement.scrollHeight > textElement.clientHeight;

// è‡ªåŠ¨è°ƒæ•´æ–‡æœ¬åŒºåŸŸ
function autoResizeTextarea(textarea) {
    textarea.style.height = 'auto';
    textarea.style.height = textarea.scrollHeight + 'px';
}
            </div>
          </div>

          <div class="case-example">
            <h4>æƒ…å†µ 3: åŠ¨æ€åŠ è½½å†…å®¹</h4>
            <p>å¼‚æ­¥åŠ è½½å†…å®¹æ—¶ scrollHeight ä¼šæ›´æ–°ï¼š</p>
            <div class="code-block">
// åŠ¨æ€å†…å®¹åŠ è½½å¯¹ scrollHeight çš„å½±å“
const container = document.getElementById('container');
let initialHeight = container.scrollHeight;

async function loadMoreContent() {
    // æ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨
    showLoadingIndicator();
    
    // æ¨¡æ‹Ÿå¼‚æ­¥åŠ è½½
    const newContent = await fetchMoreData();
    
    // æ·»åŠ æ–°å†…å®¹
    container.appendChild(newContent);
    
    // scrollHeight å·²æ›´æ–°
    const newHeight = container.scrollHeight;
    console.log(`é«˜åº¦å¢åŠ : ${newHeight - initialHeight}px`);
    
    // å¦‚æœç”¨æˆ·æ¥è¿‘åº•éƒ¨ï¼Œè‡ªåŠ¨æ»šåŠ¨
    const isNearBottom = container.scrollTop + container.clientHeight >= initialHeight - 100;
    if (isNearBottom) {
        container.scrollTop = container.scrollHeight;
    }
    
    initialHeight = newHeight;
    hideLoadingIndicator();
}
            </div>
          </div>

          <h3>å®é™…åº”ç”¨åœºæ™¯</h3>
          <div class="code-block">
// åº”ç”¨ 1: æ— é™æ»šåŠ¨åŠ è½½
class InfiniteScroll {
    constructor(container, loadCallback) {
        this.container = container;
        this.loadCallback = loadCallback;
        this.isLoading = false;
        this.setup();
    }
    
    setup() {
        this.container.addEventListener('scroll', () => {
            this.checkScrollPosition();
        });
    }
    
    checkScrollPosition() {
        if (this.isLoading) return;
        
        const scrollBottom = this.container.scrollTop + this.container.clientHeight;
        const scrollHeight = this.container.scrollHeight;
        const threshold = 100; // è·ç¦»åº•éƒ¨100pxæ—¶è§¦å‘
        
        if (scrollBottom >= scrollHeight - threshold) {
            this.loadMore();
        }
    }
    
    async loadMore() {
        this.isLoading = true;
        try {
            await this.loadCallback();
        } finally {
            this.isLoading = false;
        }
    }
}

// åº”ç”¨ 2: è‡ªåŠ¨è°ƒæ•´æ–‡æœ¬åŒºåŸŸ
function setupAutoResizeTextarea(textarea) {
    function resize() {
        textarea.style.height = 'auto';
        textarea.style.height = textarea.scrollHeight + 'px';
    }
    
    textarea.addEventListener('input', resize);
    textarea.addEventListener('change', resize);
    
    // åˆå§‹è°ƒæ•´
    resize();
}

// åº”ç”¨ 3: é˜…è¯»è¿›åº¦æŒ‡ç¤ºå™¨
class ReadingProgress {
    constructor(container, progressBar) {
        this.container = container;
        this.progressBar = progressBar;
        this.setup();
    }
    
    setup() {
        this.container.addEventListener('scroll', () => {
            this.updateProgress();
        });
        this.updateProgress();
    }
    
    updateProgress() {
        const scrollableHeight = this.container.scrollHeight - this.container.clientHeight;
        const progress = scrollableHeight > 0 ? 
            (this.container.scrollTop / scrollableHeight) * 100 : 0;
        
        this.progressBar.style.width = progress + '%';
        this.progressBar.textContent = Math.round(progress) + '%';
    }
}

// åº”ç”¨ 4: å¹³æ»‘æ»šåŠ¨åˆ°å…ƒç´ 
function smoothScrollToElement(container, targetElement) {
    const elementTop = targetElement.offsetTop;
    const elementHeight = targetElement.offsetHeight;
    const containerHeight = container.clientHeight;
    
    const targetScroll = elementTop - (containerHeight - elementHeight) / 2;
    smoothScrollTo(container, targetScroll);
}

function smoothScrollTo(element, targetPosition, duration = 500) {
    const startPosition = element.scrollTop;
    const distance = targetPosition - startPosition;
    let startTime = null;
    
    function animation(currentTime) {
        if (startTime === null) startTime = currentTime;
        const timeElapsed = currentTime - startTime;
        const progress = Math.min(timeElapsed / duration, 1);
        
        const easeOutCubic = progress => 1 - Math.pow(1 - progress, 3);
        element.scrollTop = startPosition + distance * easeOutCubic(progress);
        
        if (timeElapsed < duration) {
            requestAnimationFrame(animation);
        }
    }
    
    requestAnimationFrame(animation);
}

// åº”ç”¨ 5: è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–
class VirtualScroll {
    constructor(container, itemHeight, totalItems) {
        this.container = container;
        this.itemHeight = itemHeight;
        this.totalItems = totalItems;
        this.visibleItemCount = Math.ceil(container.clientHeight / itemHeight);
        this.setup();
    }
    
    setup() {
        // è®¾ç½®å®¹å™¨é«˜åº¦ä»¥ä¿æŒæ­£ç¡®çš„æ»šåŠ¨æ¡
        this.container.style.height = (this.totalItems * this.itemHeight) + 'px';
        
        this.container.addEventListener('scroll', () => {
            this.renderVisibleItems();
        });
        
        this.renderVisibleItems();
    }
    
    renderVisibleItems() {
        const scrollTop = this.container.scrollTop;
        const startIndex = Math.floor(scrollTop / this.itemHeight);
        const endIndex = Math.min(startIndex + this.visibleItemCount + 2, this.totalItems);
        
        // åªæ¸²æŸ“å¯è§é¡¹
        this.renderItems(startIndex, endIndex);
        
        // æ›´æ–°é¡¹çš„ä½ç½®
        this.updateItemPositions(startIndex, endIndex);
    }
    
    updateTotalItems(newTotal) {
        this.totalItems = newTotal;
        this.container.style.height = (this.totalItems * this.itemHeight) + 'px';
    }
}

// åº”ç”¨ 6: å†…å®¹å˜åŒ–æ£€æµ‹
class ContentChangeDetector {
    constructor(container) {
        this.container = container;
        this.lastScrollHeight = container.scrollHeight;
        this.setupObserver();
    }
    
    setupObserver() {
        const observer = new MutationObserver((mutations) => {
            const newScrollHeight = this.container.scrollHeight;
            if (newScrollHeight !== this.lastScrollHeight) {
                this.onContentChange(newScrollHeight, this.lastScrollHeight);
                this.lastScrollHeight = newScrollHeight;
            }
        });
        
        observer.observe(this.container, {
            childList: true,
            subtree: true,
            characterData: true
        });
    }
    
    onContentChange(newHeight, oldHeight) {
        const change = newHeight - oldHeight;
        console.log(`å†…å®¹é«˜åº¦å˜åŒ–: ${change}px (${oldHeight} â†’ ${newHeight})`);
        
        // å¯ä»¥åœ¨è¿™é‡Œè§¦å‘ç›¸å…³æ“ä½œï¼Œå¦‚é‡æ–°è®¡ç®—å¸ƒå±€ç­‰
        if (Math.abs(change) > this.container.clientHeight) {
            console.log('æ£€æµ‹åˆ°å¤§å¹…å†…å®¹å˜åŒ–ï¼Œå»ºè®®ä¼˜åŒ–');
        }
    }
}

// åº”ç”¨ 7: åˆ†é¡µè®¡ç®—
function calculatePagination(container, itemSelector) {
    const items = container.querySelectorAll(itemSelector);
    const containerHeight = container.clientHeight;
    let currentPage = 1;
    
    function getVisibleItems() {
        const scrollTop = container.scrollTop;
        const scrollBottom = scrollTop + containerHeight;
        
        const visibleItems = Array.from(items).filter(item => {
            const itemTop = item.offsetTop;
            const itemBottom = itemTop + item.offsetHeight;
            return itemBottom > scrollTop && itemTop < scrollBottom;
        });
        
        return visibleItems;
    }
    
    function goToPage(page) {
        const itemsPerPage = Math.floor(containerHeight / items[0].offsetHeight);
        const targetScroll = (page - 1) * itemsPerPage * items[0].offsetHeight;
        smoothScrollTo(container, targetScroll);
    }
    
    function getTotalPages() {
        const totalHeight = container.scrollHeight;
        const pageHeight = containerHeight;
        return Math.ceil(totalHeight / pageHeight);
    }
    
    return {
        getVisibleItems,
        goToPage,
        getTotalPages,
        getCurrentPage: () => currentPage
    };
}
          </div>

          <h3>æ€§èƒ½ä¼˜åŒ–å’Œæœ€ä½³å®è·µ</h3>
          <div class="special-cases">
            <p><strong>scrollHeight ä¼šè§¦å‘é‡æ’ï¼Œä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ï¼š</strong></p>
            <ul>
              <li>é¿å…åœ¨å¾ªç¯æˆ–é¢‘ç¹è°ƒç”¨çš„å‡½æ•°ä¸­è¯»å– scrollHeight</li>
              <li>ä½¿ç”¨é˜²æŠ–æˆ–èŠ‚æµé™åˆ¶ scroll äº‹ä»¶çš„å¤„ç†é¢‘ç‡</li>
              <li>ç¼“å­˜è®¡ç®—ç»“æœï¼Œé¿å…é‡å¤è¯»å–</li>
              <li>ä½¿ç”¨ ResizeObserver ç›‘å¬å°ºå¯¸å˜åŒ–</li>
            </ul>
            <div class="code-block">
// æ€§èƒ½ä¼˜åŒ–ç¤ºä¾‹
class OptimizedScrollHandler {
    constructor(container) {
        this.container = container;
        this.cachedScrollHeight = null;
        this.setup();
    }
    
    setup() {
        // ä½¿ç”¨é˜²æŠ–ä¼˜åŒ–æ»šåŠ¨äº‹ä»¶
        this.debouncedScrollHandler = this.debounce(() => {
            this.handleScroll();
        }, 50);
        
        this.container.addEventListener('scroll', this.debouncedScrollHandler);
        
        // ç›‘å¬å°ºå¯¸å˜åŒ–
        this.resizeObserver = new ResizeObserver(() => {
            this.cachedScrollHeight = null; // æ¸…é™¤ç¼“å­˜
        });
        this.resizeObserver.observe(this.container);
    }
    
    getScrollHeight() {
        // è¿”å›ç¼“å­˜å€¼ï¼Œé¿å…é‡æ’
        if (this.cachedScrollHeight === null) {
            this.cachedScrollHeight = this.container.scrollHeight;
        }
        return this.cachedScrollHeight;
    }
    
    handleScroll() {
        const scrollHeight = this.getScrollHeight();
        const clientHeight = this.container.clientHeight;
        const scrollTop = this.container.scrollTop;
        
        // ä½¿ç”¨ç¼“å­˜çš„å€¼è¿›è¡Œè®¡ç®—
        const scrollBottom = scrollTop + clientHeight;
        const scrollPercent = (scrollTop / (scrollHeight - clientHeight)) * 100;
        
        // å¤„ç†æ»šåŠ¨é€»è¾‘...
    }
    
    debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }
}
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // è·å–DOMå…ƒç´ 
      const scrollElement = document.getElementById("scrollElement");
      const scrollContent = document.getElementById("scrollContent");
      const scrollIndicator = document.getElementById("scrollIndicator");
      const scrollHeightValue = document.getElementById("scrollHeightValue");
      const dimensionVisualization = document.getElementById("dimensionVisualization");
      const collapsibleContent = document.getElementById("collapsibleContent");

      // è·å–æ˜¾ç¤ºå…ƒç´ 
      const scrollHeightVal = document.getElementById("scrollHeightVal");
      const clientHeightVal = document.getElementById("clientHeightVal");
      const offsetHeightVal = document.getElementById("offsetHeightVal");
      const needsScrollVal = document.getElementById("needsScrollVal");
      const overflowHeightVal = document.getElementById("overflowHeightVal");
      const scrollHeightDisplay = document.getElementById("scrollHeightDisplay");
      const clientHeightDisplay = document.getElementById("clientHeightDisplay");
      const offsetHeightDisplay = document.getElementById("offsetHeightDisplay");

      // è·å–æ§åˆ¶å…ƒç´ 
      const sectionHeightSlider = document.getElementById("sectionHeightSlider");
      const paddingSlider = document.getElementById("paddingSlider");
      const lineHeightSlider = document.getElementById("lineHeightSlider");
      const sectionHeightValue = document.getElementById("sectionHeightValue");
      const paddingValue = document.getElementById("paddingValue");
      const lineHeightValue = document.getElementById("lineHeightValue");

      // çŠ¶æ€å˜é‡
      let sectionCount = 5;
      let hasPseudoElement = false;
      let isAutoExpanding = false;

      // æ›´æ–°å±æ€§æ˜¾ç¤º
      function updateProperties() {
        const scrollHeight = scrollElement.scrollHeight;
        const clientHeight = scrollElement.clientHeight;
        const offsetHeight = scrollElement.offsetHeight;
        const needsScroll = scrollHeight > clientHeight;
        const overflowHeight = Math.max(0, scrollHeight - clientHeight);

        scrollHeightVal.textContent = scrollHeight + "px";
        clientHeightVal.textContent = clientHeight + "px";
        offsetHeightVal.textContent = offsetHeight + "px";
        needsScrollVal.textContent = needsScroll ? "æ˜¯" : "å¦";
        overflowHeightVal.textContent = overflowHeight + "px";

        // æ›´æ–°æŒ‡ç¤ºå™¨
        scrollHeightValue.textContent = scrollHeight;

        // æ›´æ–°æ¯”è¾ƒæ˜¾ç¤º
        scrollHeightDisplay.textContent = scrollHeight + "px";
        clientHeightDisplay.textContent = clientHeight + "px";
        offsetHeightDisplay.textContent = offsetHeight + "px";

        // æ›´æ–°å¯è§†åŒ–
        updateVisualization();
      }

      // æ›´æ–°å¯è§†åŒ–
      function updateVisualization() {
        const scrollHeight = scrollElement.scrollHeight;
        const clientHeight = scrollElement.clientHeight;

        const scrollHeightHighlight = document.getElementById("scrollHeightHighlight");
        const clientHeightHighlight = document.getElementById("clientHeightHighlight");

        scrollHeightHighlight.style.height = scrollHeight + "px";

        // æ›´æ–°æ ‡ç­¾
        updateDimensionLabels();
      }

      // æ›´æ–°å°ºå¯¸æ ‡ç­¾
      function updateDimensionLabels() {
        // æ¸…é™¤æ—§æ ‡ç­¾
        document.querySelectorAll(".dimension-label").forEach(label => label.remove());

        const scrollHeight = scrollElement.scrollHeight;
        const clientHeight = scrollElement.clientHeight;

        // scrollHeight æ ‡ç­¾
        const scrollHeightLabel = document.createElement("div");
        scrollHeightLabel.className = "dimension-label";
        scrollHeightLabel.style.top = scrollHeight / 2 - 20 + "px";
        scrollHeightLabel.style.left = "20px";
        scrollHeightLabel.textContent = `scrollHeight: ${scrollHeight}px`;
        dimensionVisualization.appendChild(scrollHeightLabel);

        // clientHeight æ ‡ç­¾
        const clientHeightLabel = document.createElement("div");
        clientHeightLabel.className = "dimension-label";
        clientHeightLabel.style.top = clientHeight / 2 - 20 + "px";
        clientHeightLabel.style.right = "20px";
        clientHeightLabel.textContent = `clientHeight: ${clientHeight}px`;
        dimensionVisualization.appendChild(clientHeightLabel);

        // æº¢å‡ºæŒ‡ç¤ºå™¨
        if (scrollHeight > clientHeight) {
          const overflowLabel = document.createElement("div");
          overflowLabel.className = "dimension-label";
          overflowLabel.style.top = clientHeight + (scrollHeight - clientHeight) / 2 - 20 + "px";
          overflowLabel.style.left = "20px";
          overflowLabel.textContent = `æº¢å‡º: ${scrollHeight - clientHeight}px`;
          overflowLabel.style.background = "rgba(231, 76, 60, 0.9)";
          overflowLabel.style.color = "white";
          dimensionVisualization.appendChild(overflowLabel);
        }
      }

      // æ§åˆ¶å‡½æ•°
      function addNewSection() {
        sectionCount++;
        const newSection = document.createElement("div");
        newSection.className = `content-section section-${(sectionCount % 5) + 1}`;
        newSection.innerHTML = `
                <h3>æ–°åŒºå— ${sectionCount}</h3>
                <p>åŠ¨æ€æ·»åŠ çš„å†…å®¹</p>
                <p>scrollHeight å¢åŠ äº†</p>
                <div style="margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.5); border-radius: 6px;">
                    <p>æ–°åŒºå—é«˜åº¦: 180px</p>
                    <p>å½±å“ scrollHeight è®¡ç®—</p>
                </div>
            `;
        scrollContent.appendChild(newSection);
        updateProperties();
      }

      function removeSection() {
        if (sectionCount > 1) {
          const sections = scrollContent.querySelectorAll(".content-section");
          if (sections.length > 1) {
            scrollContent.removeChild(sections[sections.length - 1]);
            sectionCount--;
            updateProperties();
          }
        }
      }

      function toggleOverflow() {
        const currentOverflow = scrollElement.style.overflowY;
        if (currentOverflow === "hidden") {
          scrollElement.style.overflowY = "auto";
        } else {
          scrollElement.style.overflowY = "hidden";
        }
        updateProperties();
      }

      function toggleCollapsible() {
        collapsibleContent.classList.toggle("expanded");
        updateProperties();
      }

      function addPseudoElement() {
        if (!hasPseudoElement) {
          const style = document.createElement("style");
          style.textContent = `
                    .scroll-content::before {
                        content: "â†‘ é¡¶éƒ¨ä¼ªå…ƒç´  â†‘";
                        display: block;
                        background: rgba(155, 89, 182, 0.3);
                        padding: 15px;
                        margin-bottom: 20px;
                        border-radius: 8px;
                        border: 1px dashed #9b59b6;
                        text-align: center;
                        font-weight: bold;
                    }
                    .scroll-content::after {
                        content: "â†“ åº•éƒ¨ä¼ªå…ƒç´  â†“";
                        display: block;
                        background: rgba(155, 89, 182, 0.3);
                        padding: 15px;
                        margin-top: 20px;
                        border-radius: 8px;
                        border: 1px dashed #9b59b6;
                        text-align: center;
                        font-weight: bold;
                    }
                `;
          document.head.appendChild(style);
          hasPseudoElement = true;
        }
        updateProperties();
      }

      function toggleAutoExpand() {
        const sections = scrollContent.querySelectorAll(".content-section");
        sections.forEach(section => {
          if (isAutoExpanding) {
            section.style.minHeight = "180px";
          } else {
            section.style.minHeight = "auto";
            section.style.height = "auto";
          }
        });
        isAutoExpanding = !isAutoExpanding;
        updateProperties();
      }

      function resetAll() {
        // é‡ç½®å†…å®¹
        scrollContent.innerHTML = `
                <div class="content-section section-1">
                    <h3>ç¬¬ä¸€éƒ¨åˆ†</h3>
                    <p>scrollHeight = å†…å®¹æ€»é«˜åº¦</p>
                    <p>åŒ…æ‹¬æ‰€æœ‰å¯è§å’Œä¸å¯è§å†…å®¹</p>
                    <div class="auto-expand">
                        <p>è¿™ä¸ªåŒºåŸŸæ¼”ç¤º scrollHeight çš„è®¡ç®—</p>
                        <p>å°è¯•è°ƒæ•´å†…å®¹é«˜åº¦è§‚å¯Ÿå˜åŒ–</p>
                    </div>
                </div>
                <div class="content-section section-2">
                    <h3>ç¬¬äºŒéƒ¨åˆ†</h3>
                    <p>åŒ…å«ä¸Šä¸‹å†…è¾¹è·</p>
                    <p>ä¸åŒ…å«è¾¹æ¡†å’Œå¤–è¾¹è·</p>
                    <div style="margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.5); border-radius: 6px;">
                        <p>å†…è¾¹è·å½±å“ scrollHeight</p>
                        <p>ä½†è¾¹æ¡†ä¸å½±å“</p>
                    </div>
                </div>
                
                <div class="collapsible-section">
                    <h4>å¯æŠ˜å å†…å®¹åŒºåŸŸ</h4>
                    <p>ç‚¹å‡»å±•å¼€/æŠ˜å è§‚å¯Ÿ scrollHeight å˜åŒ–</p>
                    <button onclick="toggleCollapsible()" style="margin-top: 10px; padding: 8px 16px; background: #f39c12; color: white; border: none; border-radius: 4px; cursor: pointer;">
                        åˆ‡æ¢æŠ˜å çŠ¶æ€
                    </button>
                    <div class="collapsible-content" id="collapsibleContent">
                        <div style="padding: 15px; background: rgba(255,255,255,0.7); margin-top: 10px; border-radius: 4px;">
                            <p>è¿™æ˜¯å¯æŠ˜å çš„å†…å®¹</p>
                            <p>å½“å†…å®¹æŠ˜å æ—¶ï¼ŒscrollHeight ä¼šå‡å°‘</p>
                            <p>å½“å†…å®¹å±•å¼€æ—¶ï¼ŒscrollHeight ä¼šå¢åŠ </p>
                            <p>è¿™ä¸ªç‰¹æ€§åœ¨å®ç°å¯æŠ˜å ç»„ä»¶æ—¶éå¸¸æœ‰ç”¨</p>
                        </div>
                    </div>
                </div>
                
                <div class="content-section section-3">
                    <h3>ç¬¬ä¸‰éƒ¨åˆ†</h3>
                    <p>ä¼ªå…ƒç´ åŒ…å«åœ¨å†…</p>
                    <p>::before å’Œ ::after</p>
                    <div style="margin-top: 15px; position: relative; padding: 15px; background: rgba(255,255,255,0.5); border-radius: 6px;">
                        <p>ä¼ªå…ƒç´ å†…å®¹</p>
                        <p>ä¹Ÿä¼šè®¡å…¥ scrollHeight</p>
                    </div>
                </div>
                <div class="content-section section-4">
                    <h3>ç¬¬å››éƒ¨åˆ†</h3>
                    <p>åŠ¨æ€å†…å®¹çš„å½±å“</p>
                    <p>å®æ—¶è®¡ç®—æ€»é«˜åº¦</p>
                    <div style="margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.5); border-radius: 6px;">
                        <p>scrollHeight æ˜¯å®æ—¶è®¡ç®—çš„</p>
                        <p>åæ˜ å½“å‰çš„å†…å®¹æ€»é«˜åº¦</p>
                    </div>
                </div>
                <div class="content-section section-5">
                    <h3>ç¬¬äº”éƒ¨åˆ†</h3>
                    <p>overflow çš„å½±å“</p>
                    <p>hidden vs visible</p>
                    <div style="margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.5); border-radius: 6px;">
                        <p>overflow ä¸å½±å“ scrollHeight</p>
                        <p>ä½†å½±å“æ˜¯å¦éœ€è¦æ»šåŠ¨æ¡</p>
                    </div>
                </div>
            `;

        // é‡æ–°è·å–å¯æŠ˜å å†…å®¹å…ƒç´ 
        collapsibleContent = document.getElementById("collapsibleContent");

        // é‡ç½®æ§åˆ¶
        sectionCount = 5;
        hasPseudoElement = false;
        isAutoExpanding = false;
        scrollElement.style.overflowY = "auto";

        // ç§»é™¤ä¼ªå…ƒç´ æ ·å¼
        document.querySelectorAll("style").forEach(style => {
          if (style.textContent.includes(".scroll-content::")) {
            style.remove();
          }
        });

        // é‡ç½®æ»‘å—
        sectionHeightSlider.value = 180;
        paddingSlider.value = 20;
        lineHeightSlider.value = 1.6;
        sectionHeightValue.textContent = "180px";
        paddingValue.textContent = "20px";
        lineHeightValue.textContent = "1.6";

        updateProperties();
      }

      // äº‹ä»¶ç›‘å¬
      sectionHeightSlider.addEventListener("input", function () {
        const height = parseInt(this.value);
        const sections = scrollContent.querySelectorAll(".content-section");
        sections.forEach(section => {
          section.style.minHeight = height + "px";
        });
        sectionHeightValue.textContent = height + "px";
        updateProperties();
      });

      paddingSlider.addEventListener("input", function () {
        const padding = parseInt(this.value);
        scrollContent.style.padding = padding + "px";
        paddingValue.textContent = padding + "px";
        updateProperties();
      });

      lineHeightSlider.addEventListener("input", function () {
        const lineHeight = parseFloat(this.value);
        scrollContent.style.lineHeight = lineHeight;
        lineHeightValue.textContent = lineHeight;
        updateProperties();
      });

      // ç›‘å¬çª—å£å¤§å°å˜åŒ–
      window.addEventListener("resize", updateProperties);

      // åˆå§‹åŒ–
      updateProperties();

      // æ§åˆ¶å°æ¼”ç¤º
      setTimeout(() => {
        console.log("=== scrollHeight å±æ€§æ¼”ç¤º ===");
        console.log("åˆå§‹ scrollHeight:", scrollElement.scrollHeight);
        console.log("clientHeight:", scrollElement.clientHeight);
        console.log("offsetHeight:", scrollElement.offsetHeight);
        console.log("æ˜¯å¦éœ€è¦å‚ç›´æ»šåŠ¨:", scrollElement.scrollHeight > scrollElement.clientHeight);

        // æ¼”ç¤ºå†…å®¹è®¡ç®—
        console.log("\nğŸ”¢ å†…å®¹é«˜åº¦è®¡ç®—:");
        const sections = scrollContent.querySelectorAll(".content-section, .collapsible-section");
        let totalContentHeight = 0;
        sections.forEach(section => {
          totalContentHeight += section.offsetHeight;
        });
        const computedStyle = getComputedStyle(scrollContent);
        const paddingTop = parseInt(computedStyle.paddingTop);
        const paddingBottom = parseInt(computedStyle.paddingBottom);

        console.log("åŒºå—æ€»é«˜åº¦:", totalContentHeight);
        console.log("å†…è¾¹è·:", paddingTop + paddingBottom);
        console.log("è®¡ç®—æ€»é«˜åº¦:", totalContentHeight + paddingTop + paddingBottom);
        console.log("å®é™… scrollHeight:", scrollElement.scrollHeight);

        // æ¼”ç¤ºå¯æŠ˜å å†…å®¹çš„å½±å“
        console.log("\nğŸ“¦ å¯æŠ˜å å†…å®¹å½±å“:");
        console.log("æŠ˜å çŠ¶æ€ scrollHeight:", scrollElement.scrollHeight);
        collapsibleContent.classList.add("expanded");
        setTimeout(() => {
          console.log("å±•å¼€çŠ¶æ€ scrollHeight:", scrollElement.scrollHeight);
          collapsibleContent.classList.remove("expanded");
        }, 1000);
      }, 1000);
    </script>
  </body>
</html>
