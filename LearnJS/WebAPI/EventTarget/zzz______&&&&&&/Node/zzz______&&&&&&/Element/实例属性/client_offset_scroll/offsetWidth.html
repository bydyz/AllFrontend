<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>offsetWidth 属性详解</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        color: #333;
        line-height: 1.6;
        padding: 20px;
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      header {
        text-align: center;
        margin-bottom: 40px;
        padding: 30px;
        background: white;
        border-radius: 15px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        border-left: 5px solid #3498db;
      }

      h1 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 2.8rem;
        background: linear-gradient(135deg, #3498db, #2c3e50);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .subtitle {
        color: #7f8c8d;
        font-size: 1.3rem;
        max-width: 800px;
        margin: 0 auto;
      }

      .content-wrapper {
        display: flex;
        flex-wrap: wrap;
        gap: 30px;
        margin-bottom: 40px;
      }

      .explanation {
        flex: 1;
        min-width: 350px;
        background: white;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
      }

      .demo-area {
        flex: 1;
        min-width: 350px;
        background: white;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
      }

      h2 {
        color: #3498db;
        margin: 25px 0 18px;
        padding-bottom: 12px;
        border-bottom: 3px solid #f0f0f0;
        font-size: 1.8rem;
      }

      h3 {
        color: #2c3e50;
        margin: 20px 0 12px;
        font-size: 1.3rem;
      }

      p {
        margin-bottom: 18px;
        font-size: 1.05rem;
      }

      ul,
      ol {
        margin: 0 0 18px 25px;
      }

      li {
        margin-bottom: 10px;
        position: relative;
        padding-left: 10px;
      }

      li:before {
        content: "•";
        color: #3498db;
        font-weight: bold;
        position: absolute;
        left: -15px;
      }

      .demo-container {
        position: relative;
        width: 100%;
        height: 350px;
        background: linear-gradient(135deg, #e8f4f8, #d1e7f0);
        border: 3px dashed #3498db;
        margin: 25px 0;
        padding: 20px;
        border-radius: 10px;
      }

      .target-element {
        width: 200px;
        height: 120px;
        background: linear-gradient(135deg, #e74c3c, #c0392b);
        color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        font-weight: bold;
        text-align: center;
        padding: 15px;
        border: 5px solid #2c3e50;
        margin: 20px auto;
      }

      .target-element:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      }

      .dimension-label {
        font-size: 0.9rem;
        opacity: 0.9;
        margin-top: 5px;
      }

      .info-panel {
        background: linear-gradient(135deg, #2c3e50, #34495e);
        color: white;
        padding: 25px;
        border-radius: 10px;
        margin-top: 25px;
        font-family: "Courier New", monospace;
        line-height: 1.8;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .controls {
        display: flex;
        gap: 12px;
        margin-top: 25px;
        flex-wrap: wrap;
      }

      button {
        padding: 12px 18px;
        background: linear-gradient(135deg, #3498db, #2980b9);
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: bold;
        flex: 1;
        min-width: 140px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        background: linear-gradient(135deg, #2980b9, #2573a7);
      }

      .code-example {
        background: linear-gradient(135deg, #2c3e50, #34495e);
        color: #ecf0f1;
        padding: 25px;
        border-radius: 10px;
        margin: 25px 0;
        overflow-x: auto;
        font-family: "Courier New", monospace;
        line-height: 1.6;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        border-left: 5px solid #3498db;
      }

      .comparison {
        display: flex;
        flex-wrap: wrap;
        gap: 25px;
        margin-top: 35px;
      }

      .comparison-item {
        flex: 1;
        min-width: 280px;
        padding: 25px;
        background: white;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
      }

      .comparison-item:hover {
        transform: translateY(-5px);
      }

      .comparison-item h3 {
        color: #3498db;
        margin-top: 0;
        padding-bottom: 15px;
        border-bottom: 2px solid #f0f0f0;
        font-size: 1.4rem;
      }

      .note {
        background: linear-gradient(135deg, #fff8e1, #ffecb3);
        padding: 20px;
        border-radius: 8px;
        border-left: 5px solid #ffc107;
        margin: 25px 0;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
      }

      .property-table {
        width: 100%;
        border-collapse: collapse;
        margin: 25px 0;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
      }

      .property-table th,
      .property-table td {
        border: 1px solid #ddd;
        padding: 15px;
        text-align: left;
      }

      .property-table th {
        background: linear-gradient(135deg, #3498db, #2980b9);
        color: white;
        font-weight: 600;
      }

      .property-table tr:nth-child(even) {
        background-color: #f9f9f9;
      }

      .property-table tr:hover {
        background-color: #f1f8ff;
      }

      .visual-guide {
        display: flex;
        justify-content: space-around;
        margin: 25px 0;
        flex-wrap: wrap;
        gap: 20px;
      }

      .guide-item {
        text-align: center;
        flex: 1;
        min-width: 180px;
      }

      .guide-box {
        width: 120px;
        height: 80px;
        margin: 0 auto 15px;
        border: 3px solid #3498db;
        position: relative;
        background: #e8f4f8;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: #2c3e50;
      }

      .guide-label {
        font-size: 1rem;
        color: #2c3e50;
        font-weight: 600;
      }

      .width-breakdown {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        border-left: 4px solid #3498db;
      }

      .breakdown-item {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        border-bottom: 1px solid #e9ecef;
      }

      .breakdown-item:last-child {
        border-bottom: none;
        font-weight: bold;
        color: #2c3e50;
      }

      footer {
        text-align: center;
        margin-top: 50px;
        padding: 25px;
        color: #7f8c8d;
        font-size: 1rem;
        background: white;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      @media (max-width: 768px) {
        .content-wrapper {
          flex-direction: column;
        }

        .comparison {
          flex-direction: column;
        }

        h1 {
          font-size: 2.2rem;
        }

        .controls {
          flex-direction: column;
        }

        button {
          min-width: 100%;
        }
      }

      .calculation {
        background: #e8f4f8;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        border-left: 4px solid #3498db;
      }

      .formula {
        font-family: "Courier New", monospace;
        font-size: 1.2rem;
        font-weight: bold;
        text-align: center;
        margin: 15px 0;
        color: #2c3e50;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>offsetWidth 属性详解</h1>
        <p class="subtitle">深入理解元素宽度计算与尺寸属性</p>
      </header>

      <div class="content-wrapper">
        <div class="explanation">
          <h2>什么是 offsetWidth？</h2>
          <p><code>offsetWidth</code> 是 JavaScript 中 DOM 元素的一个只读属性，返回元素的整体布局宽度，包括：内容宽度、内边距(padding)、边框(border)和垂直滚动条宽度（如果存在）。</p>

          <div class="code-example">
            // 获取元素的 offsetWidth 值<br />
            let element = document.getElementById("myElement");<br />
            let totalWidth = element.offsetWidth;<br />
            console.log(totalWidth); // 输出整体宽度（像素）
          </div>

          <h3>核心特性：</h3>
          <ul>
            <li><strong>只读属性</strong> - 不能直接设置，只能读取</li>
            <li><strong>包含所有水平空间</strong> - 内容 + 内边距 + 边框 + 滚动条</li>
            <li><strong>整数像素值</strong> - 返回值总是整数，四舍五入到最近的像素</li>
            <li><strong>布局宽度</strong> - 反映元素在页面中实际占据的水平空间</li>
          </ul>

          <div class="note"><strong>重要提示：</strong> offsetWidth 包含元素的边框(border)和垂直滚动条宽度，但不包含外边距(margin)。</div>

          <h3>offsetWidth 计算原理</h3>
          <p>offsetWidth 的计算公式如下：</p>

          <div class="formula">offsetWidth = content-width + padding-left + padding-right + border-left + border-right + vertical-scrollbar-width</div>

          <div class="width-breakdown">
            <h4>宽度组成分解：</h4>
            <div class="breakdown-item">
              <span>内容宽度:</span>
              <span id="contentWidth">200px</span>
            </div>
            <div class="breakdown-item">
              <span>左内边距 + 右内边距:</span>
              <span id="paddingWidth">30px</span>
            </div>
            <div class="breakdown-item">
              <span>左边框 + 右边框:</span>
              <span id="borderWidth">10px</span>
            </div>
            <div class="breakdown-item">
              <span>垂直滚动条:</span>
              <span id="scrollbarWidth">0px</span>
            </div>
            <div class="breakdown-item">
              <span>offsetWidth 总计:</span>
              <span id="totalOffsetWidth">240px</span>
            </div>
          </div>

          <div class="visual-guide">
            <div class="guide-item">
              <div class="guide-box" style="background: #e74c3c; color: white">内容</div>
              <div class="guide-label">内容宽度</div>
            </div>
            <div class="guide-item">
              <div class="guide-box" style="border: 15px solid #3498db; background: #e8f4f8">内边距</div>
              <div class="guide-label">内边距</div>
            </div>
            <div class="guide-item">
              <div class="guide-box" style="border: 8px solid #2c3e50; background: #e8f4f8">边框</div>
              <div class="guide-label">边框宽度</div>
            </div>
          </div>
        </div>

        <div class="demo-area">
          <h2>交互演示</h2>
          <p>调整下方元素属性，观察 offsetWidth 的变化：</p>

          <div class="demo-container">
            <div class="target-element" id="targetElement">
              目标元素
              <div class="dimension-label" id="dimensionLabel">宽度: 200px</div>
            </div>
          </div>

          <div class="info-panel" id="infoPanel">
            // 元素尺寸属性<br />
            offsetWidth: <strong>--</strong><br />
            clientWidth: <strong>--</strong><br />
            scrollWidth: <strong>--</strong><br />
            getComputedStyle().width: <strong>--</strong>
          </div>

          <div class="controls">
            <button id="increaseWidth">增加宽度</button>
            <button id="decreaseWidth">减少宽度</button>
            <button id="addPadding">增加内边距</button>
            <button id="addBorder">增加边框</button>
            <button id="reset">重置</button>
          </div>

          <h3>宽度属性对比</h3>
          <table class="property-table">
            <tr>
              <th>属性</th>
              <th>描述</th>
              <th>包含内容</th>
            </tr>
            <tr>
              <td>offsetWidth</td>
              <td>元素整体布局宽度</td>
              <td>内容 + 内边距 + 边框 + 滚动条</td>
            </tr>
            <tr>
              <td>clientWidth</td>
              <td>元素可视区域宽度</td>
              <td>内容 + 内边距 (不含边框和滚动条)</td>
            </tr>
            <tr>
              <td>scrollWidth</td>
              <td>元素总内容宽度</td>
              <td>内容 + 内边距 (包括溢出内容)</td>
            </tr>
            <tr>
              <td>style.width</td>
              <td>CSS宽度属性值</td>
              <td>仅内容宽度 (需显式设置)</td>
            </tr>
          </table>
        </div>
      </div>

      <div class="comparison">
        <div class="comparison-item">
          <h3>offsetWidth 与相关属性</h3>
          <p><strong>offsetWidth:</strong> 整体布局宽度（包含边框）</p>
          <p><strong>offsetHeight:</strong> 整体布局高度（包含边框）</p>
          <p><strong>clientWidth:</strong> 可视区域宽度（不含边框）</p>
          <p><strong>scrollWidth:</strong> 总内容宽度（包括溢出）</p>
          <p><strong>getBoundingClientRect().width:</strong> 元素实际宽度（浮点数）</p>
        </div>

        <div class="comparison-item">
          <h3>实际应用场景</h3>
          <p>• 响应式布局计算</p>
          <p>• 动态调整元素尺寸</p>
          <p>• 实现拖放和缩放功能</p>
          <p>• 计算元素相对位置</p>
          <p>• 创建自定义滚动条</p>
        </div>

        <div class="comparison-item">
          <h3>注意事项</h3>
          <p>• 元素 display:none 时返回 0</p>
          <p>• 包含边框和滚动条宽度</p>
          <p>• 返回值总是整数像素</p>
          <p>• 受 box-sizing 属性影响</p>
          <p>• 性能优于 getBoundingClientRect()</p>
        </div>
      </div>

      <div class="calculation">
        <h3>offsetWidth 计算示例</h3>
        <p>假设一个元素具有以下样式：</p>
        <div class="code-example">
          .example-element {<br />
          &nbsp;&nbsp;width: 200px;<br />
          &nbsp;&nbsp;padding: 15px;<br />
          &nbsp;&nbsp;border: 5px solid #333;<br />
          &nbsp;&nbsp;box-sizing: content-box;<br />
          }
        </div>
        <p>offsetWidth 计算过程：</p>
        <div class="formula">200px (内容) + 30px (内边距) + 10px (边框) = 240px</div>
      </div>

      <div class="code-example">
        // 实际使用示例：检测元素是否溢出容器<br />
        function isOverflowing(container, element) {<br />
        &nbsp;&nbsp;return element.offsetWidth > container.offsetWidth;<br />
        }<br />
        <br />
        // 动态调整元素大小以适应容器<br />
        function fitToContainer(element, container) {<br />
        &nbsp;&nbsp;let maxWidth = container.offsetWidth - 20; // 留出一些边距<br />
        &nbsp;&nbsp;if (element.offsetWidth > maxWidth) {<br />
        &nbsp;&nbsp;&nbsp;&nbsp;element.style.width = maxWidth + 'px';<br />
        &nbsp;&nbsp;}<br />
        }<br />
        <br />
        // 计算元素的真实尺寸（包括隐藏元素）<br />
        function getTrueDimensions(element) {<br />
        &nbsp;&nbsp;let clone = element.cloneNode(true);<br />
        &nbsp;&nbsp;clone.style.visibility = 'hidden';<br />
        &nbsp;&nbsp;clone.style.position = 'absolute';<br />
        &nbsp;&nbsp;document.body.appendChild(clone);<br />
        &nbsp;&nbsp;let width = clone.offsetWidth;<br />
        &nbsp;&nbsp;document.body.removeChild(clone);<br />
        &nbsp;&nbsp;return width;<br />
        }
      </div>

      <footer>
        <p>offsetWidth 属性详解 &copy; 2023 - 交互式前端教程 | 深入理解DOM元素尺寸计算</p>
      </footer>
    </div>

    <script>
      // 获取DOM元素
      const targetElement = document.getElementById("targetElement");
      const infoPanel = document.getElementById("infoPanel");
      const dimensionLabel = document.getElementById("dimensionLabel");
      const increaseWidthBtn = document.getElementById("increaseWidth");
      const decreaseWidthBtn = document.getElementById("decreaseWidth");
      const addPaddingBtn = document.getElementById("addPadding");
      const addBorderBtn = document.getElementById("addBorder");
      const resetBtn = document.getElementById("reset");

      // 获取宽度分解元素
      const contentWidthElem = document.getElementById("contentWidth");
      const paddingWidthElem = document.getElementById("paddingWidth");
      const borderWidthElem = document.getElementById("borderWidth");
      const scrollbarWidthElem = document.getElementById("scrollbarWidth");
      const totalOffsetWidthElem = document.getElementById("totalOffsetWidth");

      // 初始状态
      let currentWidth = 200;
      let currentPadding = 15;
      let currentBorder = 5;

      // 更新信息面板
      function updateInfo() {
        const offsetWidth = targetElement.offsetWidth;
        const clientWidth = targetElement.clientWidth;
        const scrollWidth = targetElement.scrollWidth;
        const computedWidth = getComputedStyle(targetElement).width;

        infoPanel.innerHTML = `
                // 元素尺寸属性<br>
                offsetWidth: <strong>${offsetWidth}px</strong><br>
                clientWidth: <strong>${clientWidth}px</strong><br>
                scrollWidth: <strong>${scrollWidth}px</strong><br>
                getComputedStyle().width: <strong>${computedWidth}</strong>
            `;

        dimensionLabel.textContent = `宽度: ${currentWidth}px`;

        // 更新宽度分解
        const paddingTotal = currentPadding * 2;
        const borderTotal = currentBorder * 2;
        const scrollbarWidth = offsetWidth - clientWidth - borderTotal;
        const totalWidth = currentWidth + paddingTotal + borderTotal + (scrollbarWidth > 0 ? scrollbarWidth : 0);

        contentWidthElem.textContent = `${currentWidth}px`;
        paddingWidthElem.textContent = `${paddingTotal}px`;
        borderWidthElem.textContent = `${borderTotal}px`;
        scrollbarWidthElem.textContent = `${scrollbarWidth > 0 ? scrollbarWidth + "px" : "0px"}`;
        totalOffsetWidthElem.textContent = `${totalWidth}px`;
      }

      // 初始更新
      updateInfo();

      // 点击目标元素显示信息
      targetElement.addEventListener("click", function () {
        updateInfo();
        // 添加点击反馈
        this.style.transform = "scale(0.95)";
        setTimeout(() => {
          this.style.transform = "";
        }, 200);
      });

      // 增加宽度
      increaseWidthBtn.addEventListener("click", function () {
        currentWidth += 20;
        targetElement.style.width = currentWidth + "px";
        updateInfo();
      });

      // 减少宽度
      decreaseWidthBtn.addEventListener("click", function () {
        currentWidth = Math.max(100, currentWidth - 20);
        targetElement.style.width = currentWidth + "px";
        updateInfo();
      });

      // 增加内边距
      addPaddingBtn.addEventListener("click", function () {
        currentPadding += 5;
        targetElement.style.padding = currentPadding + "px";
        updateInfo();
      });

      // 增加边框
      addBorderBtn.addEventListener("click", function () {
        currentBorder += 1;
        targetElement.style.borderWidth = currentBorder + "px";
        updateInfo();
      });

      // 重置
      resetBtn.addEventListener("click", function () {
        currentWidth = 200;
        currentPadding = 15;
        currentBorder = 5;
        targetElement.style.width = currentWidth + "px";
        targetElement.style.padding = currentPadding + "px";
        targetElement.style.borderWidth = currentBorder + "px";
        updateInfo();
      });

      // 初始信息显示
      setTimeout(updateInfo, 100);

      // 添加窗口调整大小时的更新
      window.addEventListener("resize", updateInfo);
    </script>
  </body>
</html>
