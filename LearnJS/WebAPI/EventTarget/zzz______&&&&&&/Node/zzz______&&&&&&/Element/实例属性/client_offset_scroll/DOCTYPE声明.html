<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>documentElement.scrollTop vs body.scrollTop 详解</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: #333;
        line-height: 1.6;
        padding: 20px;
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      header {
        text-align: center;
        margin-bottom: 40px;
        padding: 30px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }

      h1 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 2.5rem;
      }

      .subtitle {
        color: #7f8c8d;
        font-size: 1.2rem;
      }

      .content-wrapper {
        display: flex;
        flex-wrap: wrap;
        gap: 30px;
        margin-bottom: 40px;
      }

      .explanation {
        flex: 1;
        min-width: 350px;
        background: rgba(255, 255, 255, 0.95);
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      }

      .demo-area {
        flex: 1;
        min-width: 350px;
        background: rgba(255, 255, 255, 0.95);
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      }

      h2 {
        color: #667eea;
        margin: 20px 0 15px;
        padding-bottom: 10px;
        border-bottom: 2px solid #f0f0f0;
      }

      h3 {
        color: #2c3e50;
        margin: 15px 0 10px;
      }

      p {
        margin-bottom: 15px;
      }

      .code-example {
        background: #2c3e50;
        color: #ecf0f1;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        overflow-x: auto;
        font-family: "Courier New", monospace;
        line-height: 1.5;
        border-left: 4px solid #667eea;
      }

      .comparison-table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .comparison-table th,
      .comparison-table td {
        border: 1px solid #ddd;
        padding: 12px;
        text-align: left;
      }

      .comparison-table th {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        font-weight: 600;
      }

      .comparison-table tr:nth-child(even) {
        background-color: #f9f9f9;
      }

      .comparison-table tr:hover {
        background-color: #f1f8ff;
      }

      .mode-indicator {
        padding: 10px 15px;
        border-radius: 5px;
        font-weight: bold;
        margin: 10px 0;
        text-align: center;
      }

      .standard-mode {
        background: #4ecdc4;
        color: white;
      }

      .quirks-mode {
        background: #ff6b6b;
        color: white;
      }

      .scroll-demo {
        height: 200px;
        overflow: auto;
        border: 2px solid #667eea;
        border-radius: 8px;
        padding: 15px;
        margin: 15px 0;
        background: #f8f9fa;
      }

      .scroll-content {
        height: 500px;
        background: linear-gradient(45deg, #4ecdc4, #44a08d, #667eea, #764ba2);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        text-align: center;
      }

      .info-panel {
        height: 400px;
        background: #2c3e50;
        color: white;
        padding: 20px;
        border-radius: 8px;
        margin-top: 20px;
        font-family: "Courier New", monospace;
        line-height: 1.8;
      }

      .visual-guide {
        display: flex;
        justify-content: space-around;
        margin: 20px 0;
        flex-wrap: wrap;
        gap: 15px;
      }

      .guide-item {
        text-align: center;
        flex: 1;
        min-width: 150px;
      }

      .guide-box {
        width: 100px;
        height: 80px;
        margin: 0 auto 10px;
        border: 2px solid #667eea;
        position: relative;
        background: #e8f4f8;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
      }

      .guide-label {
        font-size: 0.9rem;
        color: #2c3e50;
      }

      .note {
        background: #fff8e1;
        padding: 15px;
        border-radius: 6px;
        border-left: 4px solid #ffc107;
        margin: 20px 0;
      }

      .warning {
        background: #ffebee;
        padding: 15px;
        border-radius: 6px;
        border-left: 4px solid #f44336;
        margin: 20px 0;
      }

      .browser-test {
        background: #e8f4f8;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        border: 2px solid #667eea;
      }

      footer {
        text-align: center;
        margin-top: 40px;
        padding: 20px;
        color: white;
        font-size: 0.9rem;
      }

      @media (max-width: 768px) {
        .content-wrapper {
          flex-direction: column;
        }
      }

      .doctype-example {
        background: #f5f5f5;
        padding: 15px;
        border-radius: 5px;
        margin: 10px 0;
        border-left: 4px solid #4caf50;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>documentElement.scrollTop vs body.scrollTop 详解</h1>
        <p class="subtitle">深入理解浏览器渲染模式与滚动位置获取的区别</p>
      </header>

      <div class="content-wrapper">
        <div class="explanation">
          <h2>核心概念解析</h2>

          <h3>什么是 DOCTYPE？</h3>
          <p>DOCTYPE（文档类型声明）告诉浏览器使用哪种文档类型定义（DTD）来解析文档。</p>

          <div class="doctype-example">
            <strong>标准模式（有 DOCTYPE）：</strong><br />
            &lt;!DOCTYPE html&gt;
          </div>

          <div class="doctype-example" style="border-left-color: #f44336">
            <strong>怪异模式（无 DOCTYPE）：</strong><br />
            （省略 DOCTYPE 声明）
          </div>

          <h3>两种滚动位置获取方式</h3>

          <div class="code-example">
            // 标准模式 - 使用 documentElement<br />
            document.documentElement.scrollTop<br /><br />

            // 怪异模式 - 使用 body<br />
            document.body.scrollTop
          </div>

          <div class="note"><strong>注意：</strong> document.documentElement 指向 &lt;html&gt; 元素，而 document.body 指向 &lt;body&gt; 元素。</div>

          <h3>为什么会有这种区别？</h3>
          <p>这种差异源于历史原因：</p>
          <ul>
            <li>早期浏览器（IE6/7）将滚动位置存储在 body 元素上</li>
            <li>现代标准浏览器将滚动位置存储在 html 元素上</li>
            <li>DOCTYPE 声明决定了浏览器使用哪种渲染模式</li>
          </ul>

          <div class="visual-guide">
            <div class="guide-item">
              <div class="guide-box" style="background: #4ecdc4; color: white">&lt;html&gt;</div>
              <div class="guide-label">documentElement<br />标准模式</div>
            </div>
            <div class="guide-item">
              <div class="guide-box" style="background: #ff6b6b; color: white">&lt;body&gt;</div>
              <div class="guide-label">body<br />怪异模式</div>
            </div>
          </div>
        </div>

        <div class="demo-area">
          <h2>实时演示</h2>

          <div class="mode-indicator" id="modeIndicator">检测文档模式中...</div>

          <div class="scroll-demo">
            <div class="scroll-content">
              滚动这个区域<br />
              观察下方数值变化
            </div>
          </div>

          <div class="info-panel">
            // 当前文档模式<br />
            document.compatMode: <span id="compatMode">--</span><br /><br />

            // 滚动位置检测<br />
            document.documentElement.scrollTop: <span id="docElementScrollTop">0</span><br />
            document.body.scrollTop: <span id="bodyScrollTop">0</span><br /><br />

            // 兼容性写法结果<br />
            document.documentElement.scrollTop || document.body.scrollTop: <span id="compatResult">0</span>
          </div>

          <div class="browser-test">
            <h3>浏览器兼容性测试</h3>
            <p>在不同浏览器中测试这些属性的表现：</p>

            <table class="comparison-table">
              <tr>
                <th>浏览器</th>
                <th>标准模式</th>
                <th>怪异模式</th>
              </tr>
              <tr>
                <td>Chrome</td>
                <td>documentElement</td>
                <td>body</td>
              </tr>
              <tr>
                <td>Firefox</td>
                <td>documentElement</td>
                <td>body</td>
              </tr>
              <tr>
                <td>Safari</td>
                <td>documentElement</td>
                <td>body</td>
              </tr>
              <tr>
                <td>Edge</td>
                <td>documentElement</td>
                <td>body</td>
              </tr>
              <tr>
                <td>IE 9+</td>
                <td>documentElement</td>
                <td>body</td>
              </tr>
              <tr>
                <td>IE 6-8</td>
                <td>body</td>
                <td>body</td>
              </tr>
            </table>
          </div>
        </div>
      </div>

      <table class="comparison-table">
        <tr>
          <th>特性</th>
          <th>document.documentElement.scrollTop</th>
          <th>document.body.scrollTop</th>
        </tr>
        <tr>
          <td>适用模式</td>
          <td>标准模式（有 DOCTYPE）</td>
          <td>怪异模式（无 DOCTYPE）</td>
        </tr>
        <tr>
          <td>对应元素</td>
          <td>&lt;html&gt; 元素</td>
          <td>&lt;body&gt; 元素</td>
        </tr>
        <tr>
          <td>现代浏览器</td>
          <td>✅ 推荐使用</td>
          <td>❌ 不推荐</td>
        </tr>
        <tr>
          <td>旧版IE</td>
          <td>❌ IE6-8不支持</td>
          <td>✅ 唯一选择</td>
        </tr>
        <tr>
          <td>性能</td>
          <td>相同</td>
          <td>相同</td>
        </tr>
        <tr>
          <td>可读性</td>
          <td>更符合标准</td>
          <td>历史遗留</td>
        </tr>
      </table>

      <div class="content-wrapper">
        <div class="explanation">
          <h2>实际应用建议</h2>

          <h3>推荐写法</h3>
          <div class="code-example">
            // 兼容所有情况的写法<br />
            const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;<br />
            const scrollLeft = document.documentElement.scrollLeft || document.body.scrollLeft;
          </div>

          <h3>现代替代方案</h3>
          <div class="code-example">
            // 使用 window.pageYOffset (推荐)<br />
            const scrollTop = window.pageYOffset;<br /><br />

            // 使用 window.scrollY (更现代)<br />
            const scrollTop = window.scrollY;
          </div>

          <div class="note"><strong>最佳实践：</strong> 在现代项目中，优先使用 <code>window.pageYOffset</code> 或 <code>window.scrollY</code>。</div>

          <h3>设置滚动位置</h3>
          <div class="code-example">
            // 设置滚动位置（同样需要兼容处理）<br />
            document.documentElement.scrollTop = 100;<br />
            document.body.scrollTop = 100; // 确保怪异模式生效<br /><br />

            // 现代推荐写法<br />
            window.scrollTo(0, 100);<br />
            // 或使用平滑滚动<br />
            window.scrollTo({<br />
            &nbsp;&nbsp;top: 100,<br />
            &nbsp;&nbsp;behavior: 'smooth'<br />
            });
          </div>
        </div>

        <div class="demo-area">
          <h2>代码示例</h2>

          <h3>回到顶部功能</h3>
          <div class="code-example">
            function scrollToTop() {<br />
            &nbsp;&nbsp;// 传统兼容写法<br />
            &nbsp;&nbsp;document.documentElement.scrollTop = 0;<br />
            &nbsp;&nbsp;document.body.scrollTop = 0;<br />
            &nbsp;&nbsp;<br />
            &nbsp;&nbsp;// 现代推荐写法<br />
            &nbsp;&nbsp;window.scrollTo({<br />
            &nbsp;&nbsp;&nbsp;&nbsp;top: 0,<br />
            &nbsp;&nbsp;&nbsp;&nbsp;behavior: 'smooth'<br />
            &nbsp;&nbsp;});<br />
            }
          </div>

          <h3>检测滚动方向</h3>
          <div class="code-example">
            let lastScrollTop = 0;<br /><br />

            window.addEventListener('scroll', function() {<br />
            &nbsp;&nbsp;const scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;<br />
            &nbsp;&nbsp;<br />
            &nbsp;&nbsp;if (scrollTop > lastScrollTop) {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;console.log('向下滚动');<br />
            &nbsp;&nbsp;} else {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;console.log('向上滚动');<br />
            &nbsp;&nbsp;}<br />
            &nbsp;&nbsp;<br />
            &nbsp;&nbsp;lastScrollTop = scrollTop;<br />
            });
          </div>

          <div class="warning"><strong>重要提醒：</strong> 在 React、Vue 等现代框架中，避免直接操作 DOM，使用框架提供的滚动处理方式。</div>
        </div>
      </div>

      <div class="code-example">
        // 完整的滚动位置工具函数<br />
        const ScrollUtils = {<br />
        &nbsp;&nbsp;// 获取滚动位置<br />
        &nbsp;&nbsp;getScrollPosition() {<br />
        &nbsp;&nbsp;&nbsp;&nbsp;return {<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x: window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y: window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop<br />
        &nbsp;&nbsp;&nbsp;&nbsp;};<br />
        &nbsp;&nbsp;},<br />
        &nbsp;&nbsp;<br />
        &nbsp;&nbsp;// 设置滚动位置<br />
        &nbsp;&nbsp;setScrollPosition(x, y, behavior = 'auto') {<br />
        &nbsp;&nbsp;&nbsp;&nbsp;if (window.scrollTo) {<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.scrollTo({<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left: x,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;top: y,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;behavior: behavior<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br />
        &nbsp;&nbsp;&nbsp;&nbsp;} else {<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// 兼容旧浏览器<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.documentElement.scrollLeft = x;<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.documentElement.scrollTop = y;<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.body.scrollLeft = x;<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.body.scrollTop = y;<br />
        &nbsp;&nbsp;&nbsp;&nbsp;}<br />
        &nbsp;&nbsp;},<br />
        &nbsp;&nbsp;<br />
        &nbsp;&nbsp;// 检测是否滚动到底部<br />
        &nbsp;&nbsp;isScrollToBottom(threshold = 0) {<br />
        &nbsp;&nbsp;&nbsp;&nbsp;const scrollPosition = this.getScrollPosition();<br />
        &nbsp;&nbsp;&nbsp;&nbsp;const windowHeight = window.innerHeight;<br />
        &nbsp;&nbsp;&nbsp;&nbsp;const documentHeight = Math.max(<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.body.scrollHeight,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.documentElement.scrollHeight<br />
        &nbsp;&nbsp;&nbsp;&nbsp;);<br />
        &nbsp;&nbsp;&nbsp;&nbsp;<br />
        &nbsp;&nbsp;&nbsp;&nbsp;return scrollPosition.y + windowHeight >= documentHeight - threshold;<br />
        &nbsp;&nbsp;}<br />
        };
      </div>

      <footer>
        <p>documentElement.scrollTop vs body.scrollTop 详解 &copy; 2023 - 交互式前端教程</p>
      </footer>
    </div>

    <script>
      // 检测文档模式并更新显示
      function updateModeInfo() {
        const compatMode = document.compatMode;
        const modeIndicator = document.getElementById("modeIndicator");
        const compatModeSpan = document.getElementById("compatMode");

        if (compatMode === "CSS1Compat") {
          modeIndicator.textContent = "📚 标准模式 (有 DOCTYPE)";
          modeIndicator.className = "mode-indicator standard-mode";
          compatModeSpan.textContent = '"CSS1Compat" (标准模式)';
        } else {
          modeIndicator.textContent = "⚠️ 怪异模式 (无 DOCTYPE)";
          modeIndicator.className = "mode-indicator quirks-mode";
          compatModeSpan.textContent = '"BackCompat" (怪异模式)';
        }
      }

      // 更新滚动位置信息
      function updateScrollInfo() {
        const docElementScrollTop = document.documentElement.scrollTop;
        const bodyScrollTop = document.body.scrollTop;
        const compatResult = docElementScrollTop || bodyScrollTop;

        document.getElementById("docElementScrollTop").textContent = docElementScrollTop;
        document.getElementById("bodyScrollTop").textContent = bodyScrollTop;
        document.getElementById("compatResult").textContent = compatResult;
      }

      // 初始更新
      updateModeInfo();
      updateScrollInfo();

      // 监听滚动事件
      window.addEventListener("scroll", updateScrollInfo);

      // 页面加载完成后执行
      window.addEventListener("load", function () {
        updateModeInfo();
        updateScrollInfo();

        // 输出详细信息到控制台
        console.log("文档模式:", document.compatMode);
        console.log("document.documentElement.scrollTop:", document.documentElement.scrollTop);
        console.log("document.body.scrollTop:", document.body.scrollTop);
        console.log("window.pageYOffset:", window.pageYOffset);
        console.log("window.scrollY:", window.scrollY);
      });
    </script>
  </body>
</html>
